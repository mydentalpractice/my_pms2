DROP VIEW IF EXISTS `vw_appointment_count`;
DROP VIEW IF EXISTS `vw_appointment_count_sub`;
DROP VIEW IF EXISTS `vw_appointment_monthly`;
DROP VIEW IF EXISTS `vw_appointment_today`;
DROP VIEW IF EXISTS `vw_appointment_weekly`;
DROP VIEW IF EXISTS `vw_appointmentmemberlist`;
DROP VIEW IF EXISTS `vw_appointmentreminders`;
DROP VIEW IF EXISTS `vw_appointments`;
DROP VIEW IF EXISTS `vw_assignedmembers`;
DROP VIEW IF EXISTS `vw_casereport`;
DROP VIEW IF EXISTS `vw_dentalcasesheet`;
DROP VIEW IF EXISTS `vw_dentalprocedure`;
DROP VIEW IF EXISTS `vw_dentalprocedure_chart`;
DROP VIEW IF EXISTS `vw_dentalprocedure_x999`;
DROP VIEW IF EXISTS `vw_enrollmentstatus`;
DROP VIEW IF EXISTS `vw_enrollmentstatus1`;
DROP VIEW IF EXISTS `vw_fonepaise`;
DROP VIEW IF EXISTS `vw_hmoprocedurepriceplan`;
DROP VIEW IF EXISTS `vw_imagememberlist`;
DROP VIEW IF EXISTS `vw_member`;
DROP VIEW IF EXISTS `vw_memberlist`;
DROP VIEW IF EXISTS `vw_memberonly`;
DROP VIEW IF EXISTS `vw_memberpatientlist`;
DROP VIEW IF EXISTS `vw_memberpayment`;
DROP VIEW IF EXISTS `vw_members`;
DROP VIEW IF EXISTS `vw_membertreatmentplans_detail_rpt`;
DROP VIEW IF EXISTS `vw_membertreatmentplans_header_rpt`;
DROP VIEW IF EXISTS `vw_patientmember`;
DROP VIEW IF EXISTS `vw_patientmemberappointment`;
DROP VIEW IF EXISTS `vw_patientmemberbirthday`;
DROP VIEW IF EXISTS `vw_patientmemberdependants`;
DROP VIEW IF EXISTS `vw_patientprescription`;
DROP VIEW IF EXISTS `vw_patienttreatment_detail_rpt`;
DROP VIEW IF EXISTS `vw_patienttreatment_header_rpt`;
DROP VIEW IF EXISTS `vw_payment_treatmentplan_treatment`;
DROP VIEW IF EXISTS `vw_paymentgroup`;
DROP VIEW IF EXISTS `vw_paymentlist`;
DROP VIEW IF EXISTS `vw_payments`;
DROP VIEW IF EXISTS `vw_paymentsummary`;
DROP VIEW IF EXISTS `vw_paymentsummary1`;
DROP VIEW IF EXISTS `vw_paymenttotalpaid`;
DROP VIEW IF EXISTS `vw_paymenttxlog`;
DROP VIEW IF EXISTS `vw_primarypatientlist`;
DROP VIEW IF EXISTS `vw_procedurepriceplan`;
DROP VIEW IF EXISTS `vw_procedurepriceplan_relgr`;
DROP VIEW IF EXISTS `vw_procedurepriceplan_x999`;
DROP VIEW IF EXISTS `vw_procedurepriceplancode`;
DROP VIEW IF EXISTS `vw_provider`;
DROP VIEW IF EXISTS `vw_providercapitation`;
DROP VIEW IF EXISTS `vw_tooth`;
DROP VIEW IF EXISTS `vw_treatment_procedure_group`;
DROP VIEW IF EXISTS `vw_treatmentlist`;
DROP VIEW IF EXISTS `vw_treatmentpaymentreport`;
DROP VIEW IF EXISTS `vw_treatmentplancost`;
DROP VIEW IF EXISTS `vw_treatmentplanlist`;
DROP VIEW IF EXISTS `vw_treatmentplansummary`;
DROP VIEW IF EXISTS `vw_treatmentplansummarybypatient`;
DROP VIEW IF EXISTS `vw_treatmentplansummarybytreatment`;
DROP VIEW IF EXISTS `vw_treatmentprocedure`;
DROP VIEW IF EXISTS `vw_webdependantlist`;
DROP VIEW IF EXISTS `vw_webdependants`;
DROP VIEW IF EXISTS `vw_doctor`;

DROP VIEW IF EXISTS vw_memberpaymentx;
DROP VIEW IF EXISTS vw_providertotalrevenue;
DROP VIEW IF EXISTS vw_providerreveniewytd;
DROP VIEW IF EXISTS vw_memberdata;
DROP VIEW IF EXISTS vw_memberpaymentreport;
DROP VIEW IF EXISTS vw_rlgprovider;
DROP VIEW IF EXISTS vw_relgrtreatmentprocedure;


CREATE VIEW `vw_appointment_count_sub` AS select `t_appointment`.`doctor` AS `doctor`,count(0) AS `appointments`,`t_appointment`.`provider` AS `provider`,`t_appointment`.`f_start_time` AS `starttime`,`t_appointment`.`is_active` AS `appactive` from `t_appointment` where (`t_appointment`.`is_active` = 'T') group by `t_appointment`.`f_start_time`,`t_appointment`.`doctor`;
CREATE VIEW `vw_appointment_count` AS select `doctor`.`id` AS `doctorid`,`doctor`.`name` AS `name`,`doctor`.`color` AS `color`,`doctor`.`providerid` AS `providerid`,`doctor`.`is_active` AS `is_active`,`vw_appointment_count_sub`.`appointments` AS `appointments`,`vw_appointment_count_sub`.`starttime` AS `starttime` from (`doctor` left join `vw_appointment_count_sub` on(((`doctor`.`id` = `vw_appointment_count_sub`.`doctor`) and (`doctor`.`providerid` = `vw_appointment_count_sub`.`provider`)))) where (`doctor`.`stafftype` <> 'Staff');
CREATE VIEW `vw_procedurepriceplan` AS select `procedurepriceplan`.`id` AS `id`,`procedurepriceplan`.`providerid` AS `providerid`,`procedurepriceplan`.`procedurepriceplancode` AS `procedurepriceplancode`,`procedurepriceplan`.`procedurecode` AS `procedurecode`,concat(`procedurepriceplan`.`procedurecode`,' : ',`dentalprocedure`.`shortdescription`) AS `longprocedurecode`,concat('[',concat(`dentalprocedure`.`keywords`,concat(']',concat(':',concat(`dentalprocedure`.`shortdescription`,' : ',`procedurepriceplan`.`procedurecode`))))) AS `shortdescription`,`dentalprocedure`.`shortdescription` AS `altshortdescription`,`dentalprocedure`.`description` AS `description`,`dentalprocedure`.`category` AS `category`,`dentalprocedure`.`id` AS `procedureid`,`procedurepriceplan`.`ucrfee` AS `ucrfee`,`procedurepriceplan`.`procedurefee` AS `procedurefee`,`procedurepriceplan`.`copay` AS `copay`,`procedurepriceplan`.`inspays` AS `inspays`,`procedurepriceplan`.`companypays` AS `companypays`,`procedurepriceplan`.`remarks` AS `remarks`,`procedurepriceplan`.`is_free` AS `is_free`,`procedurepriceplan`.`relgrproc` AS `relgrproc`,`procedurepriceplan`.`relgrprocdesc` AS `relgrprocdesc`,`procedurepriceplan`.`service_id` AS `service_id`,`procedurepriceplan`.`service_name` AS `service_name`,`procedurepriceplan`.`service_category` AS `service_category`,`procedurepriceplan`.`is_active` AS `is_active` from (`procedurepriceplan` left join `dentalprocedure` on((`dentalprocedure`.`dentalprocedure` = `procedurepriceplan`.`procedurecode`)));
CREATE VIEW `vw_procedurepriceplan_relgr` AS select `procedurepriceplan`.`id` AS `id`,`procedurepriceplan`.`providerid` AS `providerid`,`procedurepriceplan`.`procedurepriceplancode` AS `procedurepriceplancode`,`procedurepriceplan`.`procedurecode` AS `procedurecode`,concat(`procedurepriceplan`.`procedurecode`,' : ',`dentalprocedure`.`shortdescription`) AS `longprocedurecode`,concat('[',concat(`dentalprocedure`.`keywords`,concat(']',concat(':',concat(`dentalprocedure`.`shortdescription`,' : ',`procedurepriceplan`.`procedurecode`))))) AS `shortdescription`,`dentalprocedure`.`shortdescription` AS `altshortdescription`,`dentalprocedure`.`description` AS `description`,`dentalprocedure`.`category` AS `category`,`dentalprocedure`.`id` AS `procedureid`,`procedurepriceplan`.`ucrfee` AS `ucrfee`,`procedurepriceplan`.`procedurefee` AS `procedurefee`,`procedurepriceplan`.`copay` AS `copay`,`procedurepriceplan`.`inspays` AS `inspays`,`procedurepriceplan`.`relgrprocfee` AS `relgrprocfee`,`procedurepriceplan`.`relgrcopay` AS `relgrcopay`,`procedurepriceplan`.`relgrinspays` AS `relgrinspays`,`procedurepriceplan`.`companypays` AS `companypays`,`procedurepriceplan`.`remarks` AS `remarks`,`procedurepriceplan`.`is_free` AS `is_free`,`procedurepriceplan`.`relgrproc` AS `relgrproc`,`procedurepriceplan`.`relgrprocdesc` AS `relgrprocdesc`,`procedurepriceplan`.`service_id` AS `service_id`,`procedurepriceplan`.`service_name` AS `service_name`,`procedurepriceplan`.`service_category` AS `service_category`,`procedurepriceplan`.`is_active` AS `is_active` from (`procedurepriceplan` left join `dentalprocedure` on((`dentalprocedure`.`dentalprocedure` = `procedurepriceplan`.`procedurecode`)));

CREATE VIEW `vw_treatmentplancost` AS select `treatmentplan`.`primarypatient` AS `primarypatient`,sum(ifnull(`treatmentplan`.`totaltreatmentcost`,0)) AS `totaltreatmentcost`,sum(ifnull(`treatmentplan`.`totalcopay`,0)) AS `totalcopay`,sum(ifnull(`treatmentplan`.`totalinspays`,0)) AS `totalinspays`,((sum(ifnull(`treatmentplan`.`totaltreatmentcost`,0)) - sum(ifnull(`treatmentplan`.`totalinspays`,0))) - sum(ifnull(`treatmentplan`.`totalcopay`,0))) AS `totalmemberpays` from `treatmentplan` where (`treatmentplan`.`is_active` = 'T') group by `treatmentplan`.`primarypatient`;

CREATE VIEW `vw_memberpatientlist` AS select `patientmember`.`id` AS `id`,`patientmember`.`id` AS `patientid`,`patientmember`.`id` AS `primarypatientid`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`groupref` AS `groupref`,'P' AS `patienttype`,`patientmember`.`title` AS `title`,`patientmember`.`fname` AS `fname`,`patientmember`.`lname` AS `lname`,concat(ifnull(`patientmember`.`fname`,''),' ',ifnull(`patientmember`.`lname`,'')) AS `fullname`,concat(ifnull(`patientmember`.`fname`,''),' ',ifnull(`patientmember`.`lname`,''),' :',ifnull(`patientmember`.`patientmember`,'')) AS `patient`,`patientmember`.`cell` AS `cell`,`patientmember`.`email` AS `email`,concat(ifnull(`patientmember`.`patientmember`,''),' ',ifnull(`patientmember`.`fname`,''),' ',ifnull(`patientmember`.`mname`,''),' ',ifnull(`patientmember`.`lname`,''),'  ',ifnull(`patientmember`.`cell`,''),' ',ifnull(`patientmember`.`email`,'')) AS `pattern`,`patientmember`.`dob` AS `dob`,`patientmember`.`gender` AS `gender`,'Self' AS `relation`,`patientmember`.`image` AS `image`,`patientmember`.`groupregion` AS `regionid`,`patientmember`.`provider` AS `providerid`,`patientmember`.`is_active` AS `is_active`,`patientmember`.`hmopatientmember` AS `hmopatientmember`,`patientmember`.`hmoplan` AS `hmoplan`,`patientmember`.`company` AS `company`,`patientmember`.`newmember` AS `newmember`,`patientmember`.`freetreatment` AS `freetreatment`,cast((case when isnull(`patientmember`.`dob`) then 0 when (year(`patientmember`.`dob`) = 0) then 0 else ((year(now()) * 1.0) - (year(`patientmember`.`dob`) * 1.0)) end) as unsigned) AS `age`,cast(`patientmember`.`premstartdt` as date) AS `premstartdt`,cast(`patientmember`.`premenddt` as date) AS `premenddt`,`hmoplan`.`name` AS `hmoplanname`,`hmoplan`.`hmoplancode` AS `hmoplancode`,`hmoplan`.`procedurepriceplancode` AS `procedurepriceplancode`,`vw_treatmentplancost`.`totaltreatmentcost` AS `totaltreatmentcost`,`vw_treatmentplancost`.`totalmemberpays` AS `totaldue`,1 AS `created_by`,'2016-01-01' AS `created_on`,1 AS `modified_by`,'2016-01-01' AS `modified_on` from ((`patientmember` left join `hmoplan` on((`patientmember`.`hmoplan` = `hmoplan`.`id`))) left join `vw_treatmentplancost` on((`patientmember`.`id` = `vw_treatmentplancost`.`primarypatient`))) union select `patientmemberdependants`.`id` AS `id`,`patientmemberdependants`.`id` AS `patientid`,`patientmemberdependants`.`patientmember` AS `primarypatientid`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`groupref` AS `groupref`,'D' AS `patienttype`,`patientmemberdependants`.`title` AS `title`,`patientmemberdependants`.`fname` AS `fname`,`patientmemberdependants`.`lname` AS `lname`,concat(`patientmemberdependants`.`fname`,' ',`patientmemberdependants`.`lname`) AS `fullname`,concat(`patientmemberdependants`.`fname`,' ',`patientmemberdependants`.`lname`,' :',`patientmember`.`patientmember`) AS `patient`,`patientmember`.`cell` AS `cell`,`patientmember`.`email` AS `email`,concat(`patientmemberdependants`.`fname`,' ',`patientmemberdependants`.`lname`,'  ',`patientmember`.`cell`,' ',`patientmember`.`email`) AS `pattern`,`patientmemberdependants`.`depdob` AS `dob`,`patientmemberdependants`.`gender` AS `gender`,`patientmemberdependants`.`relation` AS `relation`,'' AS `image`,`patientmember`.`groupregion` AS `regionid`,`patientmember`.`provider` AS `providerid`,`patientmemberdependants`.`is_active` AS `is_active`,`patientmember`.`hmopatientmember` AS `hmopatientmember`,`patientmember`.`hmoplan` AS `hmoplan`,`patientmember`.`company` AS `company`,`patientmemberdependants`.`newmember` AS `newmember`,`patientmemberdependants`.`freetreatment` AS `freetreatment`,cast((case when isnull(`patientmemberdependants`.`depdob`) then 0 when (year(`patientmemberdependants`.`depdob`) = 0) then 0 else ((year(now()) * 1.0) - (year(`patientmemberdependants`.`depdob`) * 1.0)) end) as unsigned) AS `age`,cast(`patientmember`.`premstartdt` as date) AS `premstartdt`,cast(`patientmember`.`premenddt` as date) AS `premenddt`,`hmoplan`.`name` AS `hmoplanname`,`hmoplan`.`hmoplancode` AS `hmoplancode`,`hmoplan`.`procedurepriceplancode` AS `procedurepriceplancode`,0 AS `totaltreatmentcost`,0 AS `totaldue`,1 AS `created_by`,'2016-01-01' AS `created_on`,1 AS `modified_by`,'2016-01-01' AS `modified_on` from ((`patientmemberdependants` left join `patientmember` on((`patientmember`.`id` = `patientmemberdependants`.`patientmember`))) left join `hmoplan` on((`patientmember`.`hmoplan` = `hmoplan`.`id`))) order by `ID` desc;

CREATE VIEW `vw_treatmentlist` AS select `treatment`.`id` AS `id`,`treatment`.`treatment` AS `treatment`,`treatment`.`chiefcomplaint` AS `chiefcomplaint`,`treatment`.`startdate` AS `startdate`,`treatment`.`enddate` AS `enddate`,`treatment`.`status` AS `status`,`treatment`.`quadrant` AS `quadrant`,`treatment`.`tooth` AS `tooth`,`treatment`.`description` AS `notes`,`treatment`.`treatmentcost` AS `treatmentcost`,`doctor`.`id` AS `doctorid`,`doctor`.`name` AS `doctorname`,`treatment`.`is_active` AS `is_active`,`treatment`.`modified_on` AS `modified_on`,`vw_procedurepriceplan`.`procedurecode` AS `dentalprocedure`,`vw_procedurepriceplan`.`shortdescription` AS `shortdescription`,`treatmentplan`.`id` AS `tplanid`,`treatmentplan`.`treatmentplan` AS `treatmentplan`,`treatmentplan`.`pattitle` AS `title`,`treatmentplan`.`patientname` AS `patientname`,`treatmentplan`.`primarypatient` AS `memberid`,`treatmentplan`.`patient` AS `patientid`,`treatmentplan`.`provider` AS `providerid`,`vw_memberpatientlist`.`groupref` AS `groupref`,`vw_memberpatientlist`.`patientmember` AS `patientmember`,`vw_memberpatientlist`.`company` AS `companyid`,`provider`.`providername` AS `providername`,concat(`treatmentplan`.`patientname`,':',`treatment`.`treatment`) AS `pattreatment`,concat(`treatmentplan`.`patientname`,' ',`treatment`.`treatment`) AS `pattern` from (((((`treatment` left join `vw_procedurepriceplan` on((`vw_procedurepriceplan`.`id` = `treatment`.`dentalprocedure`))) left join `treatmentplan` on((`treatmentplan`.`id` = `treatment`.`treatmentplan`))) left join `doctor` on((`doctor`.`id` = `treatment`.`doctor`))) left join `provider` on((`provider`.`id` = `treatmentplan`.`provider`))) left join `vw_memberpatientlist` on(((`vw_memberpatientlist`.`primarypatientid` = `treatmentplan`.`primarypatient`) and (`vw_memberpatientlist`.`patientid` = `treatmentplan`.`patient`))));





CREATE VIEW `vw_appointment_today` AS select `t_appointment`.`id` AS `id`,`t_appointment`.`f_title` AS `f_title`,`t_appointment`.`f_patientname` AS `f_patientname`,`t_appointment`.`f_start_time` AS `f_start_time`,`t_appointment`.`f_duration` AS `f_duration`,`t_appointment`.`f_status` AS `f_status`,`t_appointment`.`description` AS `description`,`t_appointment`.`provider` AS `providerid`,`doctor`.`name` AS `doctorname`,`doctor`.`id` AS `doctorid`,`vw_treatmentlist`.`id` AS `treatmentid`,`vw_treatmentlist`.`treatment` AS `treatment`,`vw_treatmentlist`.`patientid` AS `patientid`,`vw_treatmentlist`.`memberid` AS `memberid`,`t_appointment`.`cell` AS `patientcell`,`t_appointment`.`newpatient` AS `newpatient`,(case `t_appointment`.`newpatient` when 'T' then 'New Patient' when 'F' then 'Current Patient' else 'Unknown' end) AS `patienttype`,(case `t_appointment`.`blockappt` when 'T' then 'Appointment is blocked' else '' end) AS `appointmentblock`,`doctor`.`color` AS `doccolor`,`t_appointment`.`color` AS `apptcolor`,`t_appointment`.`is_active` AS `is_active` from ((`t_appointment` left join `doctor` on((`doctor`.`id` = `t_appointment`.`doctor`))) left join `vw_treatmentlist` on((`vw_treatmentlist`.`id` = `t_appointment`.`f_treatmentid`))) where (cast(`t_appointment`.`f_start_time` as date) = curdate());
CREATE VIEW `vw_appointment_weekly` AS select `t_appointment`.`id` AS `id`,`t_appointment`.`f_title` AS `f_title`,`t_appointment`.`f_patientname` AS `f_patientname`,`t_appointment`.`f_start_time` AS `f_start_time`,`t_appointment`.`f_duration` AS `f_duration`,`t_appointment`.`f_status` AS `f_status`,`t_appointment`.`description` AS `description`,`t_appointment`.`provider` AS `providerid`,`doctor`.`name` AS `doctorname`,`doctor`.`id` AS `doctorid`,`vw_treatmentlist`.`id` AS `treatmentid`,`vw_treatmentlist`.`treatment` AS `treatment`,`vw_treatmentlist`.`patientid` AS `patientid`,`vw_treatmentlist`.`memberid` AS `memberid`,`t_appointment`.`cell` AS `patientcell`,`t_appointment`.`newpatient` AS `newpatient`,(case `t_appointment`.`newpatient` when 'T' then 'New Patient' when 'F' then 'Current Patient' else 'Unknown' end) AS `patienttype`,(case `t_appointment`.`blockappt` when 'T' then 'Appointment is blocked' else '' end) AS `appointmentblock`,`doctor`.`color` AS `doccolor`,`t_appointment`.`color` AS `apptcolor`,`t_appointment`.`is_active` AS `is_active` from ((`t_appointment` left join `doctor` on((`doctor`.`id` = `t_appointment`.`doctor`))) left join `vw_treatmentlist` on((`vw_treatmentlist`.`id` = `t_appointment`.`f_treatmentid`))) where ((year(`t_appointment`.`f_start_time`) = year(curdate())) and (month(`t_appointment`.`f_start_time`) = month(curdate())) and (week(`t_appointment`.`f_start_time`,0) = week(curdate(),0)));
CREATE VIEW `vw_appointment_monthly` AS select `t_appointment`.`id` AS `id`,`t_appointment`.`f_title` AS `f_title`,`t_appointment`.`f_patientname` AS `f_patientname`,`t_appointment`.`f_start_time` AS `f_start_time`,`t_appointment`.`f_duration` AS `f_duration`,`t_appointment`.`f_status` AS `f_status`,`t_appointment`.`description` AS `description`,`t_appointment`.`provider` AS `providerid`,`doctor`.`name` AS `doctorname`,`doctor`.`id` AS `doctorid`,`doctor`.`cell` AS `doccell`,`vw_treatmentlist`.`id` AS `treatmentid`,`vw_treatmentlist`.`treatment` AS `treatment`,`vw_treatmentlist`.`patientid` AS `patientid`,`vw_treatmentlist`.`memberid` AS `memberid`,`t_appointment`.`cell` AS `patientcell`,`t_appointment`.`newpatient` AS `newpatient`,(case `t_appointment`.`newpatient` when 'T' then 'New Patient' when 'F' then 'Current Patient' else 'Unknown' end) AS `patienttype`,(case `t_appointment`.`blockappt` when 'T' then 'Appointment is blocked' else '' end) AS `appointmentblock`,`doctor`.`color` AS `doccolor`,`t_appointment`.`color` AS `apptcolor`,`t_appointment`.`is_active` AS `is_active` from ((`t_appointment` left join `doctor` on((`doctor`.`id` = `t_appointment`.`doctor`))) left join `vw_treatmentlist` on((`vw_treatmentlist`.`id` = `t_appointment`.`f_treatmentid`))) where ((year(`t_appointment`.`f_start_time`) = year(curdate())) and (month(`t_appointment`.`f_start_time`) = month(curdate())));
CREATE VIEW `vw_appointmentmemberlist` AS select 1 AS `id`,concat('New Patient',' :') AS `patient`,1 AS `providerid`,'T' AS `is_active`,'F' AS `hmopatientmember` union select `patientmember`.`id` AS `id`,concat(`patientmember`.`fname`,' ',`patientmember`.`lname`,' :',`patientmember`.`patientmember`) AS `patient`,`patientmember`.`provider` AS `providerid`,`patientmember`.`is_active` AS `is_active`,`patientmember`.`hmopatientmember` AS `hmopatientmember` from `patientmember` union select `patientmemberdependants`.`id` AS `id`,concat(`patientmemberdependants`.`fname`,' ',`patientmemberdependants`.`lname`,' :',`patientmember`.`patientmember`) AS `patient`,`patientmember`.`provider` AS `providerid`,`patientmemberdependants`.`is_active` AS `is_active`,`patientmember`.`hmopatientmember` AS `hmopatientmember` from (`patientmemberdependants` left join `patientmember` on((`patientmember`.`id` = `patientmemberdependants`.`patientmember`))) order by `id`;
CREATE VIEW `vw_appointmentreminders` AS select `t_appointment`.`id` AS `id`,`t_appointment`.`f_title` AS `title`,`t_appointment`.`f_start_time` AS `starttime`,`t_appointment`.`f_end_time` AS `endtime`,`t_appointment`.`f_location` AS `place`,`t_appointment`.`is_active` AS `activeappt`,cast(`t_appointment`.`f_start_time` as date) AS `startdate`,cast(`t_appointment`.`f_end_time` as date) AS `enddate`,`vw_memberpatientlist`.`patientmember` AS `patientmember`,`vw_memberpatientlist`.`fname` AS `fname`,`vw_memberpatientlist`.`lname` AS `lname`,`vw_memberpatientlist`.`email` AS `email`,`vw_memberpatientlist`.`cell` AS `cell`,`vw_memberpatientlist`.`gender` AS `gender`,`vw_memberpatientlist`.`hmopatientmember` AS `hmopatientmember`,`t_appointment`.`patient` AS `patient`,`t_appointment`.`provider` AS `provider`,`appointmentreminders`.`lastreminder` AS `lastreminder` from ((`t_appointment` left join `vw_memberpatientlist` on((`vw_memberpatientlist`.`patientid` = `t_appointment`.`patient`))) left join `appointmentreminders` on((`appointmentreminders`.`appointmentid` = `t_appointment`.`id`)));



CREATE VIEW `vw_appointments` AS select `t_appointment`.`id` AS `id`,`t_appointment`.`f_uniqueid` AS `f_uniqueid`,`t_appointment`.`f_title` AS `f_title`,`t_appointment`.`ptitle` AS `ptitle`,`t_appointment`.`f_patientname` AS `f_patientname`,`t_appointment`.`f_start_time` AS `f_start_time`,`t_appointment`.`f_end_time` AS `f_end_time`,`t_appointment`.`f_duration` AS `f_duration`,`t_appointment`.`f_location` AS `f_location`,`t_appointment`.`f_treatmentid` AS `f_treatmentid`,`t_appointment`.`f_status` AS `f_status`,`t_appointment`.`description` AS `description`,`t_appointment`.`provider` AS `provider`,`t_appointment`.`doctor` AS `doctor`,`t_appointment`.`patientmember` AS `patientmember`,`t_appointment`.`patient` AS `patient`,`t_appointment`.`cell` AS `cell`,`t_appointment`.`newpatient` AS `newpatient`,`t_appointment`.`blockappt` AS `blockappt`,`t_appointment`.`sendsms` AS `sendsms`,`t_appointment`.`sendrem` AS `sendrem`,`t_appointment`.`smsaction` AS `smsaction`,`t_appointment`.`is_active` AS `is_active`,`t_appointment`.`created_on` AS `created_on`,`t_appointment`.`created_by` AS `created_by`,`t_appointment`.`modified_on` AS `modified_on`,`t_appointment`.`modified_by` AS `modified_by`,`doctor`.`name` AS `docname`,`doctor`.`cell` AS `doccell`,`doctor`.`email` AS `docemail`,`doctor`.`color` AS `color`,`doctor`.`docsms` AS `docsms`,`doctor`.`docemail` AS `docemailflag`,`doctor`.`groupsms` AS `groupsms`,`doctor`.`groupemail` AS `groupemail`,`provider`.`cell` AS `provcell`,`provider`.`providername` AS `provname`,`provider`.`email` AS `provemail`,`provider`.`practicename` AS `clinic`,`provider`.`telephone` AS `provtel`,`vw_memberpatientlist`.`company` AS `companyid`,`vw_memberpatientlist`.`groupref` AS `groupref`,`vw_memberpatientlist`.`patientmember` AS `membercode` from (((`t_appointment` left join `provider` on((`provider`.`id` = `t_appointment`.`provider`))) left join `doctor` on((`doctor`.`id` = `t_appointment`.`doctor`))) left join `vw_memberpatientlist` on(((`vw_memberpatientlist`.`primarypatientid` = `t_appointment`.`patientmember`) and (`vw_memberpatientlist`.`patientid` = `t_appointment`.`patient`))));

CREATE VIEW `vw_assignedmembers` AS select 'P' AS `pattype`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`groupref` AS `groupref`,`patientmember`.`fname` AS `fname`,`patientmember`.`lname` AS `lname`,`patientmember`.`cell` AS `cell`,`patientmember`.`dob` AS `dob`,`patientmember`.`email` AS `email`,`patientmember`.`enrollmentdate` AS `enrollmentdate`,`patientmember`.`premenddt` AS `premenddt`,`patientmember`.`hmopatientmember` AS `hmopatientmember`,`patientmember`.`is_active` AS `is_active`,`patientmember`.`provider` AS `provider`,`company`.`company` AS `company`,`provider`.`providername` AS `providername`,`hmoplan`.`hmoplancode` AS `hmoplan` from (((`patientmember` left join `company` on((`patientmember`.`company` = `company`.`id`))) left join `provider` on((`patientmember`.`provider` = `provider`.`id`))) left join `hmoplan` on((`patientmember`.`hmoplan` = `hmoplan`.`id`))) union select 'D' AS `pattype`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`groupref` AS `groupref`,`patientmemberdependants`.`fname` AS `fname`,`patientmemberdependants`.`lname` AS `lname`,`patientmember`.`cell` AS `cell`,`patientmemberdependants`.`depdob` AS `dob`,`patientmember`.`email` AS `email`,`patientmember`.`enrollmentdate` AS `enrollmentdate`,`patientmember`.`premenddt` AS `premenddt`,`patientmember`.`hmopatientmember` AS `hmopatientmember`,`patientmember`.`is_active` AS `is_active`,`patientmember`.`provider` AS `provider`,`company`.`company` AS `company`,`provider`.`providername` AS `providername`,`hmoplan`.`hmoplancode` AS `hmoplan` from ((((`patientmemberdependants` left join `patientmember` on((`patientmemberdependants`.`patientmember` = `patientmember`.`id`))) left join `company` on((`company`.`id` = `patientmember`.`company`))) left join `provider` on((`provider`.`id` = `patientmember`.`provider`))) left join `hmoplan` on((`patientmember`.`hmoplan` = `hmoplan`.`id`)));


CREATE VIEW `vw_casereport` AS select `casereport`.`id` AS `id`,`casereport`.`providerid` AS `providerid`,`casereport`.`memberid` AS `memberid`,`casereport`.`patientid` AS `patientid`,`casereport`.`treatmentid` AS `treatmentid`,`casereport`.`appointmentid` AS `appointmentid`,`casereport`.`casereport` AS `casereport`,`casereport`.`child_name` AS `child_name`,`casereport`.`child_class` AS `child_class`,`casereport`.`parent_name` AS `parent_name`,`casereport`.`school_name` AS `school_name`,`casereport`.`admission_number` AS `admission_number`,`casereport`.`cell` AS `cell`,`casereport`.`email` AS `email`,`casereport`.`dob` AS `dob`,`casereport`.`gender` AS `gender`,`casereport`.`cavity_milk_teeth` AS `cavity_milk_teeth`,`casereport`.`cavity_perm_teeth` AS `cavity_perm_teeth`,`casereport`.`crooked_teeth` AS `crooked_teeth`,`casereport`.`gum_problems` AS `gum_problems`,`casereport`.`emergency_consult` AS `emergency_consult`,`casereport`.`priority_checkup` AS `priority_checkup`,`casereport`.`routine_checkup` AS `routine_checkup`,`casereport`.`fluoride_check` AS `fluoride_check`,`casereport`.`image_file` AS `image_file`,`doctor`.`name` AS `doctorname`,`provider`.`providername` AS `providername`,`vw_memberpatientlist`.`fullname` AS `fullname`,`vw_memberpatientlist`.`patientmember` AS `patientmember`,`casereport`.`is_active` AS `is_active`,`casereport`.`modified_on` AS `modified_on`,`casereport`.`modified_by` AS `modified_by` from (((`casereport` left join `doctor` on((`casereport`.`doctorid` = `doctor`.`id`))) left join `provider` on((`casereport`.`providerid` = `provider`.`id`))) left join `vw_memberpatientlist` on(((`casereport`.`memberid` = `vw_memberpatientlist`.`primarypatientid`) and (`casereport`.`patientid` = `vw_memberpatientlist`.`patientid`))));
CREATE VIEW `vw_dentalcasesheet` AS select `dentalcasesheet`.`id` AS `id`,`dentalcasesheet`.`providerid` AS `providerid`,`dentalcasesheet`.`doctorid` AS `doctorid`,`dentalcasesheet`.`casereport` AS `casereport`,`dentalcasesheet`.`child_name` AS `child_name`,`dentalcasesheet`.`child_class` AS `child_class`,`dentalcasesheet`.`parent_name` AS `parent_name`,`dentalcasesheet`.`school_name` AS `school_name`,`dentalcasesheet`.`admission_number` AS `admission_number`,`dentalcasesheet`.`cell` AS `cell`,`dentalcasesheet`.`email` AS `email`,`dentalcasesheet`.`dob` AS `dob`,`dentalcasesheet`.`gender` AS `gender`,`dentalcasesheet`.`cavity_milk_teeth` AS `cavity_milk_teeth`,`dentalcasesheet`.`cavity_perm_teeth` AS `cavity_perm_teeth`,`dentalcasesheet`.`crooked_teeth` AS `crooked_teeth`,`dentalcasesheet`.`gum_problems` AS `gum_problems`,`dentalcasesheet`.`emergency_consult` AS `emergency_consult`,`dentalcasesheet`.`priority_checkup` AS `priority_checkup`,`dentalcasesheet`.`routine_checkup` AS `routine_checkup`,`dentalcasesheet`.`fluoride_check` AS `fluoride_check`,`dentalcasesheet`.`image_file` AS `image_file`,`doctor`.`name` AS `doctorname`,`provider`.`providername` AS `providername`,`dentalcasesheet`.`is_active` AS `is_active` from ((`dentalcasesheet` left join `doctor` on((`dentalcasesheet`.`doctorid` = `doctor`.`id`))) left join `provider` on((`dentalcasesheet`.`providerid` = `provider`.`id`)));

CREATE VIEW `vw_dentalprocedure` AS select `dentalprocedure`.`id` AS `id`,`dentalprocedure`.`category` AS `category`,concat(`dentalprocedure`.`keywords`,concat(':',concat(`dentalprocedure`.`shortdescription`,concat(':',concat(`dentalprocedure`.`dentalprocedure`,concat(':',concat(concat('UCR(',concat(`dentalprocedure`.`procedurefee`,concat('):',concat(`dentalprocedure`.`id`))))))))))) AS `shortdescription`,`dentalprocedure`.`shortdescription` AS `altshortdescription`,`dentalprocedure`.`description` AS `description`,`dentalprocedure`.`procedurefee` AS `procedurefee`,`dentalprocedure`.`is_active` AS `is_active` from `dentalprocedure`;
CREATE VIEW `vw_dentalprocedure_chart` AS select `dentalprocedure_chart`.`id` AS `id`,`dentalprocedure_chart`.`providerid` AS `providerid`,`dentalprocedure_chart`.`procedurecode` AS `proccode`,concat(`dentalprocedure_chart`.`description`,concat(':',concat(`dentalprocedure_chart`.`procedurecode`,concat(':',concat(`dentalprocedure_chart`.`id`))))) AS `shortdescription`,`dentalprocedure_chart`.`description` AS `altshortdescription`,`dentalprocedure_chart`.`description` AS `description`,0 AS `procedurefee`,`dentalprocedure_chart`.`color` AS `chartcolor`,'T' AS `for_chart`,`dentalprocedure_chart`.`is_active` AS `is_active` from `dentalprocedure_chart` where (`dentalprocedure_chart`.`is_active` = 'T');
CREATE VIEW `vw_dentalprocedure_x999` AS select `dentalprocedure`.`id` AS `id`,`dentalprocedure`.`category` AS `category`,`dentalprocedure`.`dentalprocedure` AS `proccode`,concat(`dentalprocedure`.`keywords`,concat(':',concat(`dentalprocedure`.`shortdescription`,concat(':',concat(`dentalprocedure`.`dentalprocedure`,concat(':',concat(concat('UCR(',concat(`dentalprocedure`.`procedurefee`,concat('):',concat(`dentalprocedure`.`id`))))))))))) AS `shortdescription`,`dentalprocedure`.`shortdescription` AS `altshortdescription`,`dentalprocedure`.`description` AS `description`,`dentalprocedure`.`procedurefee` AS `procedurefee`,`dentalprocedure`.`is_active` AS `is_active` from `dentalprocedure` where (`dentalprocedure`.`dentalprocedure` = 'G0100A');
CREATE VIEW `vw_webdependantlist` AS select `webmemberdependants`.`webmember` AS `webmember`,`webmemberdependants`.`fname` AS `fname`,`webmemberdependants`.`lname` AS `lname`,`webmemberdependants`.`relation` AS `relation` from `webmemberdependants` where (`webmemberdependants`.`is_active` = 'T') order by `webmemberdependants`.`webmember`;
CREATE VIEW `vw_webdependants` AS select count(`webmemberdependants`.`id`) AS `dependants`,`webmemberdependants`.`webmember` AS `webmember` from `webmemberdependants` where (`webmemberdependants`.`is_active` = 'T') group by `webmemberdependants`.`webmember` order by `webmemberdependants`.`webmember`;
CREATE VIEW `vw_enrollmentstatus` AS select `webmember`.`webmember` AS `webmember`,`webmember`.`groupref` AS `groupref`,`webmember`.`fname` AS `fname`,`webmember`.`lname` AS `lname`,`webmember`.`status` AS `status`,`provider`.`provider` AS `provider`,`provider`.`providername` AS `providername`,`company`.`id` AS `companyid`,`company`.`company` AS `company`,`hmoplan`.`hmoplancode` AS `hmoplancode`,`webmember`.`cell` AS `cell`,`webmember`.`webenrollcompletedate` AS `webenrollcompletedate`,`webmember`.`is_active` AS `is_active`,ifnull(`vw_webdependants`.`dependants`,0) AS `dependants` from ((((`webmember` left join `vw_webdependants` on((`vw_webdependants`.`webmember` = `webmember`.`id`))) left join `provider` on((`provider`.`id` = `webmember`.`provider`))) left join `company` on((`company`.`id` = `webmember`.`company`))) left join `hmoplan` on((`hmoplan`.`id` = `webmember`.`hmoplan`)));
CREATE VIEW `vw_enrollmentstatus1` AS select `webmember`.`id` AS `id`,`webmember`.`webmember` AS `webmember`,`webmember`.`groupref` AS `groupref`,`webmember`.`fname` AS `fname`,`webmember`.`lname` AS `lname`,`webmember`.`status` AS `status`,`provider`.`provider` AS `provider`,`provider`.`providername` AS `providername`,`company`.`id` AS `companyid`,`company`.`company` AS `company`,`hmoplan`.`hmoplancode` AS `hmoplancode`,`webmember`.`cell` AS `cell`,`webmember`.`address1` AS `address1`,`webmember`.`address2` AS `address2`,`webmember`.`address3` AS `address3`,`webmember`.`city` AS `city`,`webmember`.`st` AS `st`,`webmember`.`pin` AS `pin`,`webmember`.`email` AS `email`,`webmember`.`webenrollcompletedate` AS `webenrollcompletedate`,`webmember`.`is_active` AS `is_active`,ifnull(`vw_webdependants`.`dependants`,0) AS `dependants` from ((((`webmember` left join `vw_webdependants` on((`vw_webdependants`.`webmember` = `webmember`.`id`))) left join `provider` on((`provider`.`id` = `webmember`.`provider`))) left join `company` on((`company`.`id` = `webmember`.`company`))) left join `hmoplan` on((`hmoplan`.`id` = `webmember`.`hmoplan`)));
CREATE VIEW `vw_fonepaise` AS select `payment`.`id` AS `id`,`payment`.`id` AS `paymentid`,`payment`.`amount` AS `invoiceamt`,`payment`.`notes` AS `notes`,`provider`.`id` AS `providerid`,`provider`.`title` AS `provtitle`,`provider`.`providername` AS `providername`,`provider`.`practicename` AS `practicename`,`treatment`.`id` AS `treatmentid`,`treatment`.`treatment` AS `invoice`,`treatment`.`treatment` AS `treatment`,`treatment`.`chiefcomplaint` AS `chiefcomplaint`,`treatment`.`description` AS `description`,`treatmentplan`.`treatmentplan` AS `treatmentplan`,`treatmentplan`.`id` AS `tplanid`,`vw_memberpatientlist`.`title` AS `title`,`vw_memberpatientlist`.`patientid` AS `patientid`,`vw_memberpatientlist`.`primarypatientid` AS `memberid`,`vw_memberpatientlist`.`patientmember` AS `patientmember`,`vw_memberpatientlist`.`fullname` AS `fullname`,`vw_memberpatientlist`.`cell` AS `mobileno`,`vw_memberpatientlist`.`email` AS `email`,`doctor`.`title` AS `doctortitle`,`doctor`.`name` AS `doctorname` from (((((`payment` left join `treatment` on((`treatment`.`treatmentplan` = `payment`.`treatmentplan`))) left join `doctor` on((`doctor`.`id` = `treatment`.`doctor`))) left join `provider` on((`provider`.`id` = `payment`.`provider`))) left join `treatmentplan` on((`treatmentplan`.`id` = `payment`.`treatmentplan`))) left join `vw_memberpatientlist` on((`vw_memberpatientlist`.`patientid` = `payment`.`patientmember`)));
CREATE VIEW `vw_hmoprocedurepriceplan` AS select `procedurepriceplan`.`id` AS `id`,`procedurepriceplan`.`providerid` AS `providerid`,`procedurepriceplan`.`procedurepriceplancode` AS `procedurepriceplancode`,`procedurepriceplan`.`procedurecode` AS `procedurecode`,'XXXX' AS `hmoplancode`,`procedurepriceplan`.`ucrfee` AS `ucrfee`,`procedurepriceplan`.`procedurefee` AS `procedurefee`,`procedurepriceplan`.`copay` AS `copay`,`procedurepriceplan`.`inspays` AS `inspays`,`procedurepriceplan`.`companypays` AS `companypays`,`procedurepriceplan`.`is_active` AS `is_active`,`dentalprocedure`.`shortdescription` AS `shortdescription` from (`procedurepriceplan` left join `dentalprocedure` on(((`dentalprocedure`.`dentalprocedure` = `procedurepriceplan`.`procedurecode`) & (`dentalprocedure`.`is_active` = 'T')))) order by `procedurepriceplan`.`procedurepriceplancode`,`procedurepriceplan`.`procedurecode`;
CREATE VIEW `vw_imagememberlist` AS select `patientmember`.`id` AS `id`,`patientmember`.`id` AS `patientid`,`patientmember`.`id` AS `primarypatientid`,`patientmember`.`patientmember` AS `patientmember`,'P' AS `patienttype`,`patientmember`.`fname` AS `fname`,`patientmember`.`lname` AS `lname`,`patientmember`.`cell` AS `cell`,`patientmember`.`email` AS `email`,`patientmember`.`provider` AS `providerid`,`patientmember`.`is_active` AS `is_active`,1 AS `created_by`,'2016-01-01' AS `created_on`,1 AS `modified_by`,'2016-01-01' AS `modified_on` from `patientmember` union select `patientmemberdependants`.`id` AS `id`,`patientmemberdependants`.`id` AS `patientid`,`patientmemberdependants`.`patientmember` AS `primarypatientid`,`patientmember`.`patientmember` AS `patientmember`,'D' AS `patienttype`,`patientmemberdependants`.`fname` AS `fname`,`patientmemberdependants`.`lname` AS `lname`,`patientmember`.`cell` AS `cell`,`patientmember`.`email` AS `email`,`patientmember`.`provider` AS `providerid`,`patientmemberdependants`.`is_active` AS `is_active`,1 AS `created_by`,'2016-01-01' AS `created_on`,1 AS `modified_by`,'2016-01-01' AS `modified_on` from (`patientmemberdependants` left join `patientmember` on((`patientmember`.`id` = `patientmemberdependants`.`patientmember`))) order by `patientmember`,`patienttype` desc;
CREATE VIEW `vw_patientmemberdependants` AS select count(`patientmemberdependants`.`id`) AS `dependants`,`patientmemberdependants`.`patientmember` AS `patientmember` from `patientmemberdependants` where (`patientmemberdependants`.`is_active` = 'T') group by `patientmemberdependants`.`patientmember` order by `patientmemberdependants`.`patientmember`;
CREATE VIEW `vw_primarypatientlist` AS select 0 AS `id`,0 AS `auxid`,'' AS `patienttype`,' ' AS `title`,'-Select-' AS `fname`,'' AS `lname`,'' AS `fullname` union select `patientmember`.`id` AS `id`,`patientmember`.`id` AS `auxid`,'P' AS `patienttype`,`patientmember`.`title` AS `title`,`patientmember`.`fname` AS `fname`,`patientmember`.`lname` AS `lname`,concat(`patientmember`.`fname`,' ',`patientmember`.`lname`) AS `fullname` from `patientmember` union select `patientmemberdependants`.`patientmember` AS `id`,`patientmemberdependants`.`id` AS `auxid`,'D' AS `patienttype`,`patientmemberdependants`.`title` AS `title`,`patientmemberdependants`.`fname` AS `fname`,`patientmemberdependants`.`lname` AS `lname`,concat(`patientmemberdependants`.`fname`,' ',`patientmemberdependants`.`lname`) AS `fullname` from `patientmemberdependants`;

CREATE VIEW `vw_paymenttxlog` AS select `paymenttxlog`.`txno` AS `txno`,`paymenttxlog`.`txdatetime` AS `txdatetime`,`paymenttxlog`.`txamount` AS `txamount`,`paymenttxlog`.`responsecode` AS `responsecode`,`paymenttxlog`.`responsemssg` AS `responsemssg`,`paymenttxlog`.`paymentid` AS `paymentid`,`paymenttxlog`.`paymentamount` AS `paymentamount`,`paymenttxlog`.`paymentdate` AS `paymentdate`,`paymenttxlog`.`paymenttxid` AS `paymenttxid`,`paymenttxlog`.`servicetax` AS `servicetax`,`paymenttxlog`.`swipecharge` AS `swipecharge`,`paymenttxlog`.`total` AS `total`,`paymenttxlog`.`webmember` AS `webmemberid`,`paymenttxlog`.`patientmember` AS `memberid`,`webmember`.`fname` AS `FirstName`,`webmember`.`lname` AS `LastName`,`webmember`.`webmember` AS `webmember`,`paymenttxlog`.`is_active` AS `is_active`,`company`.`name` AS `companyname`,`company`.`company` AS `companycode` from ((`paymenttxlog` left join `webmember` on((`webmember`.`id` = `paymenttxlog`.`webmember`))) left join `company` on((`company`.`id` = `webmember`.`company`))) order by `company`.`name`;

CREATE VIEW `vw_memberpayment` AS select `vw_paymenttxlog`.`webmemberid` AS `webmemberid`,`vw_paymenttxlog`.`paymentdate` AS `paymentdate`,sum(`vw_paymenttxlog`.`total`) AS `amount` from `vw_paymenttxlog` where (`vw_paymenttxlog`.`responsecode` = '0') group by `vw_paymenttxlog`.`webmemberid`;
CREATE VIEW `vw_member` AS select 'P' AS `pattype`,`patientmember`.`id` AS `patientmemberid`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`groupref` AS `groupref`,`patientmember`.`title` AS `title`,`patientmember`.`fname` AS `fname`,`patientmember`.`mname` AS `mname`,`patientmember`.`lname` AS `lname`,`patientmember`.`dob` AS `dob`,`patientmember`.`cell` AS `cell`,`patientmember`.`telephone` AS `telephone`,`patientmember`.`email` AS `email`,`patientmember`.`status` AS `status`,`patientmember`.`address1` AS `address1`,`patientmember`.`address2` AS `address2`,`patientmember`.`address3` AS `address3`,`patientmember`.`city` AS `city`,`patientmember`.`pin` AS `pin`,`patientmember`.`enrollmentdate` AS `enrollmentdate`,`patientmember`.`terminationdate` AS `terminationdate`,`patientmember`.`premstartdt` AS `premstartdt`,`patientmember`.`premenddt` AS `premenddt`,`patientmember`.`is_active` AS `is_active`,'Self' AS `relation`,ifnull(`vw_patientmemberdependants`.`dependants`,0) AS `dependants`,ifnull(`vw_memberpayment`.`amount`,0) AS `amount`,ifnull(`companyhmoplanrate`.`capitation`,0) AS `membercap`,0 AS `dependantcap`,`provider`.`provider` AS `provider`,`provider`.`providername` AS `providername`,`provider`.`address1` AS `provaddress1`,`provider`.`address2` AS `provaddress2`,`provider`.`address3` AS `provaddress3`,`provider`.`city` AS `provcity`,`provider`.`pin` AS `provpin`,`provider`.`email` AS `provemail`,`provider`.`telephone` AS `provtelephone`,`company`.`id` AS `companyid`,`company`.`company` AS `company`,`hmoplan`.`hmoplancode` AS `hmoplancode`,`hmoplan`.`name` AS `planname`,`agent`.`agent` AS `agent`,`agent`.`name` AS `agentname`,0 AS `agentcommission`,`webmember`.`id` AS `webmemberid`,`vw_memberpayment`.`paymentdate` AS `paymentdate`,`companyhmoplanrate`.`is_active` AS `chractive` from (((((((((`patientmember` left join `vw_patientmemberdependants` on((`vw_patientmemberdependants`.`patientmember` = `patientmember`.`id`))) left join `webmember` on((`webmember`.`webmember` = `patientmember`.`patientmember`))) left join `vw_memberpayment` on((`vw_memberpayment`.`webmemberid` = `webmember`.`id`))) left join `provider` on((`provider`.`id` = `patientmember`.`provider`))) left join `company` on((`company`.`id` = `patientmember`.`company`))) left join `hmoplan` on((`hmoplan`.`id` = `patientmember`.`hmoplan`))) left join `agent` on((`agent`.`id` = `company`.`agent`))) left join `agentcommission` on((`agentcommission`.`agent` = `agent`.`id`))) left join `companyhmoplanrate` on(((`companyhmoplanrate`.`hmoplan` = `patientmember`.`hmoplan`) and (`companyhmoplanrate`.`company` = `patientmember`.`company`) and (`companyhmoplanrate`.`groupregion` = `patientmember`.`groupregion`) and (`companyhmoplanrate`.`relation` = 'Self')))) union select 'D' AS `pattype`,`patientmemberdependants`.`id` AS `patientmemberid`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`groupref` AS `groupref`,`patientmemberdependants`.`title` AS `title`,`patientmemberdependants`.`fname` AS `fname`,`patientmemberdependants`.`mname` AS `mname`,`patientmemberdependants`.`lname` AS `lname`,`patientmember`.`dob` AS `dob`,`patientmember`.`cell` AS `cell`,`patientmember`.`telephone` AS `telephone`,`patientmember`.`email` AS `email`,`patientmember`.`status` AS `status`,`patientmember`.`address1` AS `address1`,`patientmember`.`address2` AS `address2`,`patientmember`.`address3` AS `address3`,`patientmember`.`city` AS `city`,`patientmember`.`pin` AS `pin`,`patientmember`.`enrollmentdate` AS `enrollmentdate`,`patientmember`.`terminationdate` AS `terminationdate`,`patientmember`.`premstartdt` AS `premstartdt`,`patientmember`.`premenddt` AS `premenddt`,`patientmemberdependants`.`is_active` AS `is_active`,`patientmemberdependants`.`relation` AS `relation`,0 AS `dependants`,0 AS `amount`,0 AS `membercap`,ifnull(`companyhmoplanrate`.`capitation`,0) AS `dependantcap`,`provider`.`provider` AS `provider`,`provider`.`providername` AS `providername`,`provider`.`address1` AS `provaddress1`,`provider`.`address2` AS `provaddress2`,`provider`.`address3` AS `provaddress3`,`provider`.`city` AS `provcity`,`provider`.`pin` AS `provpin`,`provider`.`email` AS `provemail`,`provider`.`telephone` AS `provtelephone`,`company`.`id` AS `companyid`,`company`.`company` AS `company`,`hmoplan`.`hmoplancode` AS `hmoplancode`,`hmoplan`.`name` AS `planname`,`agent`.`agent` AS `agent`,`agent`.`name` AS `agentname`,0 AS `agentcommission`,`webmember`.`id` AS `webmemberid`,`vw_memberpayment`.`paymentdate` AS `paymentdate`,`companyhmoplanrate`.`is_active` AS `chractive` from (((((((((`patientmemberdependants` left join `patientmember` on((`patientmemberdependants`.`patientmember` = `patientmember`.`id`))) left join `webmember` on((`webmember`.`webmember` = `patientmember`.`patientmember`))) left join `vw_memberpayment` on((`vw_memberpayment`.`webmemberid` = `webmember`.`id`))) left join `provider` on((`provider`.`id` = `patientmember`.`provider`))) left join `company` on((`company`.`id` = `patientmember`.`company`))) left join `hmoplan` on((`hmoplan`.`id` = `patientmember`.`hmoplan`))) left join `agent` on((`agent`.`id` = `company`.`agent`))) left join `agentcommission` on((`agentcommission`.`agent` = `agent`.`id`))) left join `companyhmoplanrate` on(((`companyhmoplanrate`.`hmoplan` = `patientmember`.`hmoplan`) and (`companyhmoplanrate`.`company` = `patientmember`.`company`) and (`companyhmoplanrate`.`groupregion` = `patientmember`.`groupregion`) and (`companyhmoplanrate`.`relation` <> 'Self') and (`companyhmoplanrate`.`relation` <> '')))) where (`patientmember`.`hmopatientmember` = 'T');
CREATE VIEW `vw_memberlist` AS select `patientmember`.`id` AS `id`,`patientmember`.`provider` AS `providerid`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`title` AS `title`,`patientmember`.`fname` AS `fname`,`patientmember`.`lname` AS `lname`,`patientmember`.`cell` AS `cell`,`patientmember`.`email` AS `email`,`hmoplan`.`name` AS `hmoplanname`,`hmoplan`.`hmoplancode` AS `hmoplancode`,`patientmember`.`hmopatientmember` AS `hmopatientmember`,`patientmember`.`newmember` AS `newmember`,`patientmember`.`freetreatment` AS `freetreatment`,`patientmember`.`premenddt` AS `premenddt`,`patientmember`.`is_active` AS `is_active`,`treatmentplan`.`totaltreatmentcost` AS `totaltreatmentcost`,`treatmentplan`.`totaldue` AS `totaldue`,concat_ws(`patientmember`.`fname`,' ',`patientmember`.`lname`,' (',`patientmember`.`patientmember`,')') AS `patient` from ((`patientmember` left join `hmoplan` on((`patientmember`.`hmoplan` = `hmoplan`.`id`))) left join `treatmentplan` on(((`patientmember`.`id` = `treatmentplan`.`primarypatient`) & (`treatmentplan`.`patienttype` = 'P'))));
CREATE VIEW `vw_memberonly` AS select 'P' AS `pattype`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`groupref` AS `groupref`,`patientmember`.`title` AS `title`,`patientmember`.`fname` AS `fname`,`patientmember`.`mname` AS `mname`,`patientmember`.`lname` AS `lname`,`patientmember`.`dob` AS `dob`,`patientmember`.`cell` AS `cell`,`patientmember`.`telephone` AS `telephone`,`patientmember`.`email` AS `email`,`patientmember`.`status` AS `status`,`patientmember`.`address1` AS `address1`,`patientmember`.`address2` AS `address2`,`patientmember`.`address3` AS `address3`,`patientmember`.`city` AS `city`,`patientmember`.`pin` AS `pin`,`patientmember`.`enrollmentdate` AS `enrollmentdate`,`patientmember`.`terminationdate` AS `terminationdate`,`patientmember`.`premstartdt` AS `premstartdt`,`patientmember`.`premenddt` AS `premenddt`,`patientmember`.`is_active` AS `is_active`,'Self' AS `relation`,ifnull(`vw_memberpayment`.`amount`,0) AS `amount`,ifnull(`companyhmoplanrate`.`capitation`,0) AS `membercap`,0 AS `dependantcap`,`provider`.`provider` AS `provider`,`provider`.`providername` AS `providername`,`provider`.`address1` AS `provaddress1`,`provider`.`address2` AS `provaddress2`,`provider`.`address3` AS `provaddress3`,`provider`.`city` AS `provcity`,`provider`.`pin` AS `provpin`,`provider`.`email` AS `provemail`,`provider`.`telephone` AS `provtelephone`,`company`.`id` AS `companyid`,`company`.`company` AS `company`,`hmoplan`.`hmoplancode` AS `hmoplancode`,`hmoplan`.`name` AS `planname`,`agent`.`agent` AS `agent`,`agent`.`name` AS `agentname`,0 AS `agentcommission`,`webmember`.`id` AS `webmemberid`,`vw_memberpayment`.`paymentdate` AS `paymentdate` from ((((((((`patientmember` left join `webmember` on((`webmember`.`webmember` = `patientmember`.`patientmember`))) left join `vw_memberpayment` on((`vw_memberpayment`.`webmemberid` = `webmember`.`id`))) left join `provider` on((`provider`.`id` = `patientmember`.`provider`))) left join `company` on((`company`.`id` = `patientmember`.`company`))) left join `hmoplan` on((`hmoplan`.`id` = `patientmember`.`hmoplan`))) left join `agent` on((`agent`.`id` = `company`.`agent`))) left join `agentcommission` on((`agentcommission`.`agent` = `agent`.`id`))) left join `companyhmoplanrate` on(((`companyhmoplanrate`.`hmoplan` = `patientmember`.`hmoplan`) and (`companyhmoplanrate`.`company` = `patientmember`.`company`) and (`companyhmoplanrate`.`groupregion` = `patientmember`.`groupregion`) and (`companyhmoplanrate`.`relation` = 'Self'))));
CREATE VIEW `vw_members` AS select 'P' AS `pattype`,`webmember`.`webmember` AS `webmember`,`webmember`.`groupref` AS `groupref`,`webmember`.`title` AS `title`,`webmember`.`fname` AS `fname`,`webmember`.`lname` AS `lname`,`webmember`.`cell` AS `cell`,`webmember`.`webdob` AS `dob`,`webmember`.`email` AS `email`,`webmember`.`status` AS `status`,`webmember`.`webenrolldate` AS `webenrolldate`,`webmember`.`webenrollcompletedate` AS `webenrollcompletedate`,`webmember`.`is_active` AS `is_active`,`webmember`.`provider` AS `providerid`,`webmember`.`company` AS `companyid`,`provider`.`provider` AS `provider`,`company`.`company` AS `company` from ((`webmember` left join `company` on((`webmember`.`company` = `company`.`id`))) left join `provider` on((`webmember`.`provider` = `provider`.`id`))) union select 'D' AS `pattype`,`webmember`.`webmember` AS `webmember`,`webmember`.`groupref` AS `groupref`,`webmemberdependants`.`title` AS `title`,`webmemberdependants`.`fname` AS `fname`,`webmemberdependants`.`lname` AS `lname`,`webmember`.`cell` AS `cell`,`webmemberdependants`.`depdob` AS `dob`,`webmember`.`email` AS `email`,`webmember`.`status` AS `status`,`webmember`.`webenrolldate` AS `webenrolldate`,`webmember`.`webenrollcompletedate` AS `webenrollcompletedate`,`webmember`.`is_active` AS `is_active`,`webmember`.`provider` AS `providerid`,`webmember`.`company` AS `companyid`,`provider`.`provider` AS `provider`,`company`.`company` AS `company` from (((`webmemberdependants` left join `webmember` on((`webmemberdependants`.`webmember` = `webmember`.`id`))) left join `company` on((`company`.`id` = `webmember`.`company`))) left join `provider` on((`provider`.`id` = `webmember`.`provider`)));
CREATE VIEW `vw_membertreatmentplans_detail_rpt` AS select `treatmentplan`.`id` AS `id`,`treatmentplan`.`primarypatient` AS `primarypatient`,`treatmentplan`.`patient` AS `patient`,`treatmentplan`.`treatmentplan` AS `treatmentplan`,`treatmentplan`.`provider` AS `providerid`,`treatment`.`id` AS `treatmentid`,`treatment`.`treatment` AS `treatment`,`treatment`.`status` AS `status`,`treatment`.`startdate` AS `startdate`,`treatment`.`enddate` AS `enddate`,`treatment`.`quadrant` AS `quadrant`,`treatment`.`tooth` AS `tooth`,`treatment`.`description` AS `description`,`treatment`.`treatmentcost` AS `treatmentcost`,`treatment`.`actualtreatmentcost` AS `actualtreatmentcost`,`treatment`.`copay` AS `copay`,`treatment`.`inspay` AS `inspay`,`provider`.`providername` AS `providername`,`provider`.`practicename` AS `practicename`,`provider`.`cell` AS `providercell`,`provider`.`email` AS `provideremail`,`treatmentplan`.`is_active` AS `is_active` from (((`treatmentplan` left join `treatment` on(((`treatment`.`treatmentplan` = `treatmentplan`.`id`) & (`treatment`.`is_active` = 'T')))) left join `vw_memberpatientlist` on((((`treatmentplan`.`primarypatient` = `vw_memberpatientlist`.`primarypatientid`) & (`treatmentplan`.`patient` = `vw_memberpatientlist`.`patientid`)) & (`vw_memberpatientlist`.`is_active` = 'T')))) left join `provider` on((`provider`.`id` = `treatmentplan`.`provider`))) order by `treatmentplan`.`id`;
CREATE VIEW `vw_membertreatmentplans_header_rpt` AS select `treatmentplan`.`id` AS `id`,`treatmentplan`.`primarypatient` AS `primarypatient`,`treatmentplan`.`patient` AS `patient`,`treatmentplan`.`provider` AS `providerid`,sum(ifnull(`treatmentplan`.`totaltreatmentcost`,0)) AS `totaltreatmentcost`,sum(ifnull(`treatmentplan`.`totalcopay`,0)) AS `totalcopay`,sum(ifnull(`treatmentplan`.`totalinspays`,0)) AS `totalinspays`,((sum(ifnull(`treatmentplan`.`totaltreatmentcost`,0)) - sum(ifnull(`treatmentplan`.`totalinspays`,0))) - sum(ifnull(`treatmentplan`.`totalinspays`,0))) AS `totalmemberpays`,sum(ifnull(`treatmentplan`.`totalpaid`,0)) AS `totalpaid`,sum(ifnull(`treatmentplan`.`totalcopaypaid`,0)) AS `totalcopaypaid`,sum(ifnull(`treatmentplan`.`totalinspaid`,0)) AS `totalinspaid`,sum(ifnull(`treatmentplan`.`totaldue`,0)) AS `totaldue`,`vw_memberpatientlist`.`email` AS `memberemail`,`vw_memberpatientlist`.`cell` AS `membercell`,concat(`vw_memberpatientlist`.`fname`,' ',`vw_memberpatientlist`.`lname`,' (',`vw_memberpatientlist`.`patientmember`,')') AS `membername`,concat(`vw_memberpatientlist`.`cell`,'-',`vw_memberpatientlist`.`email`) AS `membercontact`,concat(`patientmember`.`address1`,' ',`patientmember`.`address2`,' ',`patientmember`.`city`,' ',`patientmember`.`st`,' ',`patientmember`.`pin`) AS `memberaddress`,`provider`.`providername` AS `providername`,concat(`provider`.`address1`,' ',`provider`.`address2`,' ',`provider`.`city`,' ',`provider`.`st`,' ',`provider`.`pin`) AS `provaddress`,concat(`provider`.`cell`,'-',`provider`.`email`) AS `provcontact`,concat(`company`.`name`,' (',`company`.`company`,')') AS `company`,concat(`hmoplan`.`name`,' (',`hmoplan`.`hmoplancode`,')') AS `hmoplan`,`vw_memberpatientlist`.`premenddt` AS `premenddt`,`treatmentplan`.`is_active` AS `is_active` from (((((`treatmentplan` left join `vw_memberpatientlist` on((((`treatmentplan`.`primarypatient` = `vw_memberpatientlist`.`primarypatientid`) & (`treatmentplan`.`patient` = `vw_memberpatientlist`.`patientid`)) & (`vw_memberpatientlist`.`is_active` = 'T')))) left join `provider` on((`treatmentplan`.`provider` = `provider`.`id`))) left join `company` on((`vw_memberpatientlist`.`company` = `company`.`id`))) left join `hmoplan` on((`vw_memberpatientlist`.`hmoplan` = `hmoplan`.`id`))) left join `patientmember` on((`treatmentplan`.`primarypatient` = `patientmember`.`id`))) group by `treatmentplan`.`patient`;
CREATE VIEW `vw_patientmember` AS select `patientmember`.`id` AS `id`,`patientmember`.`provider` AS `providerid`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`title` AS `title`,concat(`patientmember`.`fname`,' ',`patientmember`.`lname`,' :',`patientmember`.`patientmember`) AS `patient` from `patientmember`;
CREATE VIEW `vw_patientmemberappointment` AS select `t_appointment`.`id` AS `id`,`t_appointment`.`f_title` AS `title`,`t_appointment`.`f_start_time` AS `starttime`,`t_appointment`.`f_end_time` AS `endtime`,`t_appointment`.`f_location` AS `location`,`t_appointment`.`is_active` AS `activeappt`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`groupref` AS `groupref`,`patientmember`.`title` AS `ptitle`,`patientmember`.`fname` AS `fname`,`patientmember`.`lname` AS `lname`,`patientmember`.`email` AS `email`,`patientmember`.`cell` AS `cell`,`patientmember`.`hmopatientmember` AS `hmopatientmember`,`provider`.`providername` AS `providername`,`t_appointment`.`patient` AS `patient`,`t_appointment`.`provider` AS `provider` from ((`t_appointment` left join `patientmember` on((`patientmember`.`id` = `t_appointment`.`patient`))) left join `provider` on((`provider`.`id` = `t_appointment`.`provider`))) where ((`t_appointment`.`is_active` = 'T') and ((curdate() - interval 30 day) >= `t_appointment`.`f_start_time`) and (`t_appointment`.`f_start_time` <= (curdate() + interval 30 day)));
CREATE VIEW `vw_patientmemberbirthday` AS select `vw_memberpatientlist`.`id` AS `id`,`vw_memberpatientlist`.`patientid` AS `patientid`,`vw_memberpatientlist`.`primarypatientid` AS `memberid`,`vw_memberpatientlist`.`patientmember` AS `patientmember`,`vw_memberpatientlist`.`title` AS `title`,`vw_memberpatientlist`.`fname` AS `fname`,`vw_memberpatientlist`.`lname` AS `lname`,`vw_memberpatientlist`.`dob` AS `dob`,`vw_memberpatientlist`.`gender` AS `gender`,`vw_memberpatientlist`.`email` AS `email`,`vw_memberpatientlist`.`cell` AS `cell`,`vw_memberpatientlist`.`providerid` AS `providerid`,`vw_memberpatientlist`.`is_active` AS `is_active`,`vw_memberpatientlist`.`hmopatientmember` AS `hmopatientmember`,`provider`.`providername` AS `providername`,`birthdayreminders`.`lastreminder` AS `lastreminder`,str_to_date(concat(year(curdate()),'-',month(`vw_memberpatientlist`.`dob`),'-',dayofmonth(`vw_memberpatientlist`.`dob`)),'%Y-%m-%d') AS `birthday` from ((`vw_memberpatientlist` left join `provider` on((`provider`.`id` = `vw_memberpatientlist`.`providerid`))) left join `birthdayreminders` on((`birthdayreminders`.`patient` = `vw_memberpatientlist`.`patientid`)));
CREATE VIEW `vw_patientprescription` AS select `prescription`.`id` AS `id`,`prescription`.`providerid` AS `providerid`,`prescription`.`tplanid` AS `tplanid`,`prescription`.`treatmentid` AS `treatmentid`,`prescription`.`dosage` AS `dosage`,`prescription`.`frequency` AS `frequency`,`prescription`.`quantity` AS `quantity`,`prescription`.`remarks` AS `remarks`,`prescription`.`prescriptiondate` AS `prescriptiondate`,`medicine`.`id` AS `medicineid`,`medicine`.`medicine` AS `medicine`,`medicine`.`medicinetype` AS `medicinetype`,`medicine`.`strength` AS `strength`,`medicine`.`strengthuom` AS `strengthuom`,`medicine`.`instructions` AS `instructions`,`prescription`.`patientid` AS `patientid`,`prescription`.`memberid` AS `memberid`,`vw_memberpatientlist`.`title` AS `title`,`vw_memberpatientlist`.`fullname` AS `fullname`,`vw_memberpatientlist`.`patientmember` AS `patientmember`,`vw_memberpatientlist`.`dob` AS `dob`,(year(now()) - year(`vw_memberpatientlist`.`dob`)) AS `age`,`vw_memberpatientlist`.`gender` AS `gender`,`doctor`.`id` AS `doctorid`,`doctor`.`title` AS `doctitle`,`doctor`.`name` AS `doctorname`,`prescription`.`is_active` AS `is_active` from (((`prescription` left join `medicine` on(((`medicine`.`id` = `prescription`.`medicineid`) and (`prescription`.`providerid` = `medicine`.`providerid`) and (`prescription`.`is_active` = 'T')))) left join `vw_memberpatientlist` on(((`vw_memberpatientlist`.`providerid` = `prescription`.`providerid`) and (`vw_memberpatientlist`.`patientid` = `prescription`.`patientid`) and (`vw_memberpatientlist`.`primarypatientid` = `prescription`.`memberid`)))) left join `doctor` on((`doctor`.`id` = `prescription`.`doctorid`)));
CREATE VIEW `vw_patienttreatment_detail_rpt` AS select `treatmentplan`.`id` AS `id`,`treatment`.`treatment` AS `treatment`,`treatment`.`status` AS `status`,`treatment`.`startdate` AS `startdate`,`treatment`.`enddate` AS `enddate`,`dentalprocedure`.`dentalprocedure` AS `dentalprocedure`,`dentalprocedure`.`shortdescription` AS `shortdescription`,`dentalprocedure`.`procedurefee` AS `UCR`,`treatment`.`quadrant` AS `quadrant`,`treatment`.`tooth` AS `tooth`,`treatment`.`description` AS `description`,`treatment`.`treatmentcost` AS `treatmentcost`,`treatment`.`copay` AS `copay`,`treatment`.`inspay` AS `inspay` from (((`treatmentplan` left join `treatment` on((`treatment`.`treatmentplan` = `treatmentplan`.`id`))) left join `dentalprocedure` on((`dentalprocedure`.`id` = `treatment`.`dentalprocedure`))) left join `patientmember` on((`treatmentplan`.`primarypatient` = `patientmember`.`id`)));
CREATE VIEW `vw_patienttreatment_header_rpt` AS select `treatmentplan`.`id` AS `id`,`treatmentplan`.`treatmentplan` AS `treatmentplan`,`treatmentplan`.`startdate` AS `startdate`,`treatmentplan`.`enddate` AS `enddate`,`treatmentplan`.`status` AS `status`,`treatmentplan`.`patienttype` AS `pattype`,`patientmember`.`patientmember` AS `patientmember`,`treatmentplan`.`totaltreatmentcost` AS `totaltreatmentcost`,`treatmentplan`.`totalcopay` AS `totalcopay`,`treatmentplan`.`totalinspays` AS `totalinspays`,`treatmentplan`.`totalpaid` AS `totalpaid`,`treatmentplan`.`totaldue` AS `totaldue`,`treatmentplan`.`totalcopaypaid` AS `totalcopaypaid`,`treatmentplan`.`totalinspaid` AS `totalinspaid`,`patientmember`.`title` AS `title`,concat(`patientmember`.`fname`,' ',`patientmember`.`lname`,' (',`patientmember`.`patientmember`,')') AS `membername`,`treatmentplan`.`patientname` AS `patientname`,concat(`patientmember`.`cell`,'-',`patientmember`.`email`) AS `membercontact`,concat(`patientmember`.`address1`,' ',`patientmember`.`address2`,' ',`patientmember`.`city`,' ',`patientmember`.`st`,' ',`patientmember`.`pin`) AS `memberaddress`,`provider`.`providername` AS `providername`,concat(`provider`.`address1`,' ',`provider`.`address2`,' ',`provider`.`city`,' ',`provider`.`st`,' ',`provider`.`pin`) AS `provaddress`,concat(`provider`.`cell`,'-',`provider`.`email`) AS `provcontact`,concat(`company`.`name`,' (',`company`.`company`,')') AS `company`,concat(`hmoplan`.`name`,' (',`hmoplan`.`hmoplancode`,')') AS `hmoplan`,`patientmember`.`premenddt` AS `premenddt` from ((((`treatmentplan` left join `patientmember` on((`treatmentplan`.`primarypatient` = `patientmember`.`id`))) left join `provider` on((`treatmentplan`.`provider` = `provider`.`id`))) left join `company` on((`patientmember`.`company` = `company`.`id`))) left join `hmoplan` on((`patientmember`.`hmoplan` = `hmoplan`.`id`)));
CREATE VIEW `vw_payment_treatmentplan_treatment` AS select `treatmentplan`.`id` AS `id`,`treatmentplan`.`id` AS `tplanid`,`treatmentplan`.`provider` AS `providerid`,`treatmentplan`.`primarypatient` AS `primarypatient`,`treatmentplan`.`patient` AS `patientid`,`treatmentplan`.`is_active` AS `tplanactive`,`treatmentplan`.`treatmentplan` AS `tplan`,`treatment`.`treatment` AS `treatment` from (`treatmentplan` left join `treatment` on((`treatment`.`treatmentplan` = `treatmentplan`.`id`)));
CREATE VIEW `vw_treatmentplansummary` AS select `treatmentplan`.`primarypatient` AS `memberid`,`treatmentplan`.`provider` AS `provider`,`treatmentplan`.`is_active` AS `is_active`,sum(`treatmentplan`.`totaltreatmentcost`) AS `totalcost`,sum(`treatmentplan`.`totalcopay`) AS `totalcopay`,sum(`treatmentplan`.`totalinspays`) AS `totalinspays`,sum(`treatmentplan`.`totalpaid`) AS `totalpaid`,sum(`treatmentplan`.`totaldue`) AS `totaldue`,sum(`treatmentplan`.`totalcopaypaid`) AS `totalcopaypaid`,sum(`treatmentplan`.`totalinspaid`) AS `totalinspaid` from `treatmentplan` where (`treatmentplan`.`is_active` = 'T') group by `treatmentplan`.`primarypatient`,`treatmentplan`.`provider`;
CREATE VIEW `vw_paymentsummary` AS select `payment`.`patientmember` AS `patientmember`,`payment`.`provider` AS `provider`,sum(`payment`.`amount`) AS `totalpaid`,`vw_treatmentplansummary`.`totalcost` AS `totalcost` from (`payment` left join `vw_treatmentplansummary` on((`payment`.`patientmember` = `vw_treatmentplansummary`.`memberid`))) group by `payment`.`patientmember`;
CREATE VIEW `vw_paymentsummary1` AS select `payment`.`id` AS `id`,`payment`.`patientmember` AS `patientmember`,`payment`.`provider` AS `provider`,`vw_treatmentplansummary`.`totalcost` AS `totalcost`,`vw_treatmentplansummary`.`totalinspays` AS `totalinspays`,`vw_treatmentplansummary`.`totalcopay` AS `totalcopay`,sum(`payment`.`amount`) AS `totalpaid`,(`vw_treatmentplansummary`.`totalcost` - sum(`payment`.`amount`)) AS `totaldue` from (`payment` left join `vw_treatmentplansummary` on((`payment`.`patientmember` = `vw_treatmentplansummary`.`memberid`))) group by `payment`.`patientmember`;
CREATE VIEW `vw_paymenttotalpaid` AS select `payment`.`treatmentplan` AS `id`,`payment`.`patientmember` AS `patientmember`,`payment`.`treatmentplan` AS `treatmentplan`,`payment`.`provider` AS `provider`,max(`payment`.`paymentdate`) AS `lastpaymentdate`,sum(ifnull(`payment`.`amount`,0)) AS `totalpaid` from `payment` where ((`payment`.`paymentcommit` = 'T') and (`payment`.`is_active` = 'T')) group by `payment`.`treatmentplan`;
CREATE VIEW `vw_procedurepriceplan_x999` AS select `procedurepriceplan`.`id` AS `id`,`procedurepriceplan`.`providerid` AS `providerid`,`procedurepriceplan`.`procedurepriceplancode` AS `procedurepriceplancode`,`procedurepriceplan`.`procedurecode` AS `procedurecode`,concat(`procedurepriceplan`.`procedurecode`,' : ',`dentalprocedure`.`shortdescription`) AS `longprocedurecode`,concat('[',concat(`dentalprocedure`.`keywords`,concat(']',concat(':',concat(`dentalprocedure`.`shortdescription`,' : ',`procedurepriceplan`.`procedurecode`))))) AS `shortdescription`,`dentalprocedure`.`shortdescription` AS `altshortdescription`,`dentalprocedure`.`description` AS `description`,`dentalprocedure`.`category` AS `category`,`dentalprocedure`.`id` AS `procedureid`,`procedurepriceplan`.`ucrfee` AS `ucrfee`,`procedurepriceplan`.`procedurefee` AS `procedurefee`,`procedurepriceplan`.`copay` AS `copay`,`procedurepriceplan`.`inspays` AS `inspays`,`procedurepriceplan`.`companypays` AS `companypays`,`procedurepriceplan`.`remarks` AS `remarks`,`procedurepriceplan`.`is_free` AS `is_free`,`procedurepriceplan`.`relgrproc` AS `relgrproc`,`procedurepriceplan`.`relgrprocdesc` AS `relgrprocdesc`,`procedurepriceplan`.`service_id` AS `service_id`,`procedurepriceplan`.`service_name` AS `service_name`,`procedurepriceplan`.`service_category` AS `service_category`,`procedurepriceplan`.`is_active` AS `is_active` from (`procedurepriceplan` left join `dentalprocedure` on((`dentalprocedure`.`dentalprocedure` = `procedurepriceplan`.`procedurecode`))) where (`procedurepriceplan`.`is_free` = 'T');
CREATE VIEW `vw_procedurepriceplancode` AS select `procedurepriceplan`.`id` AS `id`,`procedurepriceplan`.`procedurepriceplancode` AS `procedurepriceplancode` from `procedurepriceplan` where (`procedurepriceplan`.`is_active` = 'T') group by `procedurepriceplan`.`procedurepriceplancode`;
CREATE VIEW `vw_provider` AS select `provider`.`id` AS `id`,`provider`.`id` AS `providerid`,concat(`provider`.`providername`,' :',`provider`.`provider`) AS `provider`,`provider`.`is_active` AS `is_active` from `provider`;
CREATE VIEW `vw_providercapitation` AS select `company`.`company` AS `company`,`hmoplan`.`hmoplancode` AS `hmoplancode`,`patientmember`.`premstartdt` AS `premstartdt`,`patientmember`.`premenddt` AS `premenddt`,`companyhmoplanrate`.`capitation` AS `capitation`,`patientmember`.`provider` AS `provider`,(case when (date_format(`patientmember`.`premstartdt`,'%m') = 1) then 'Jan' when (date_format(`patientmember`.`premstartdt`,'%m') = 2) then 'Feb' when (date_format(`patientmember`.`premstartdt`,'%m') = 3) then 'Mar' when (date_format(`patientmember`.`premstartdt`,'%m') = 4) then 'Apr' when (date_format(`patientmember`.`premstartdt`,'%m') = 5) then 'May' when (date_format(`patientmember`.`premstartdt`,'%m') = 6) then 'Jun' when (date_format(`patientmember`.`premstartdt`,'%m') = 7) then 'Jul' when (date_format(`patientmember`.`premstartdt`,'%m') = 8) then 'Aug' when (date_format(`patientmember`.`premstartdt`,'%m') = 9) then 'Sep' when (date_format(`patientmember`.`premstartdt`,'%m') = 10) then 'Oct' when (date_format(`patientmember`.`premstartdt`,'%m') = 11) then 'Nov' when (date_format(`patientmember`.`premstartdt`,'%m') = 12) then 'Dec' end) AS `premmonth` from (((`patientmember` left join `company` on((`company`.`id` = `patientmember`.`company`))) left join `hmoplan` on((`hmoplan`.`id` = `company`.`hmoplan`))) left join `companyhmoplanrate` on(((`companyhmoplanrate`.`company` = `company`.`id`) and (`companyhmoplanrate`.`hmoplan` = `hmoplan`.`id`) and (`companyhmoplanrate`.`groupregion` = `patientmember`.`groupregion`) and (`companyhmoplanrate`.`is_active` = 'T') and (`companyhmoplanrate`.`relation` = 'Self')))) union select `company`.`company` AS `company`,`hmoplan`.`hmoplancode` AS `hmoplancode`,`patientmember`.`premstartdt` AS `premstartdt`,`patientmember`.`premenddt` AS `premenddt`,`companyhmoplanrate`.`capitation` AS `capitation`,`patientmember`.`provider` AS `provider`,(case when (date_format(`patientmember`.`premstartdt`,'%m') = 1) then 'Jan' when (date_format(`patientmember`.`premstartdt`,'%m') = 2) then 'Feb' when (date_format(`patientmember`.`premstartdt`,'%m') = 3) then 'Mar' when (date_format(`patientmember`.`premstartdt`,'%m') = 4) then 'Apr' when (date_format(`patientmember`.`premstartdt`,'%m') = 5) then 'May' when (date_format(`patientmember`.`premstartdt`,'%m') = 6) then 'Jun' when (date_format(`patientmember`.`premstartdt`,'%m') = 7) then 'Jul' when (date_format(`patientmember`.`premstartdt`,'%m') = 8) then 'Aug' when (date_format(`patientmember`.`premstartdt`,'%m') = 9) then 'Sep' when (date_format(`patientmember`.`premstartdt`,'%m') = 10) then 'Oct' when (date_format(`patientmember`.`premstartdt`,'%m') = 11) then 'Nov' when (date_format(`patientmember`.`premstartdt`,'%m') = 12) then 'Dec' end) AS `premmonth` from ((((`patientmemberdependants` left join `patientmember` on((`patientmember`.`id` = `patientmemberdependants`.`patientmember`))) left join `company` on((`company`.`id` = `patientmember`.`company`))) left join `hmoplan` on((`hmoplan`.`id` = `company`.`hmoplan`))) left join `companyhmoplanrate` on(((`companyhmoplanrate`.`company` = `company`.`id`) and (`companyhmoplanrate`.`hmoplan` = `hmoplan`.`id`) and (`companyhmoplanrate`.`groupregion` = `patientmember`.`groupregion`) and (`companyhmoplanrate`.`is_active` = 'T') and (`companyhmoplanrate`.`relation` = `patientmemberdependants`.`relation`))));
CREATE VIEW `vw_tooth` AS select `tooth`.`id` AS `id`,`tooth`.`toothid` AS `toothid`,`tooth`.`toothnumber` AS `toothnumber`,`tooth`.`toothsection` AS `toothsection`,`tooth`.`chartdate` AS `chartdate`,`tooth`.`notes` AS `notes`,`tooth`.`p1` AS `p1`,`tooth`.`p2` AS `p2`,`tooth`.`p3` AS `p3`,`tooth`.`p4` AS `p4`,`tooth`.`p5` AS `p5`,`tooth`.`p6` AS `p6`,`tooth`.`p7` AS `p7`,`tooth`.`p8` AS `p8`,`tooth`.`p9` AS `p9`,`tooth`.`l1` AS `l1`,`tooth`.`l2` AS `l2`,`tooth`.`l3` AS `l3`,`tooth`.`l4` AS `l4`,`tooth`.`e1` AS `e1`,`tooth`.`is_active` AS `activetooth`,`doctor`.`name` AS `doctorname`,`vw_dentalprocedure_chart`.`id` AS `procedureid`,`vw_dentalprocedure_chart`.`shortdescription` AS `shortdescription`,`vw_dentalprocedure_chart`.`altshortdescription` AS `altshortdescription`,`vw_dentalprocedure_chart`.`chartcolor` AS `chartcolor`,`provider`.`id` AS `providerid`,`dentalchart`.`id` AS `dentalchartid`,`treatment`.`id` AS `treatmentid`,`vw_memberpatientlist`.`patientid` AS `patientid`,`vw_memberpatientlist`.`primarypatientid` AS `memberid` from ((((((`tooth` left join `dentalchart` on(((`dentalchart`.`id` = `tooth`.`chartid`) and (`dentalchart`.`is_active` = 'T')))) left join `provider` on((`dentalchart`.`providerid` = `provider`.`id`))) left join `vw_memberpatientlist` on(((`dentalchart`.`patientid` = `vw_memberpatientlist`.`patientid`) and (`dentalchart`.`memberid` = `vw_memberpatientlist`.`primarypatientid`)))) left join `vw_dentalprocedure_chart` on((`vw_dentalprocedure_chart`.`id` = `tooth`.`procedureid`))) left join `doctor` on(((`doctor`.`id` = `tooth`.`doctorid`) and (`doctor`.`is_active` = 'T')))) left join `treatment` on(((`treatment`.`id` = `tooth`.`treatmentid`) and (`treatment`.`is_active` = 'T'))));
CREATE VIEW `vw_treatmentpaymentreport` AS select `treatmentplan`.`id` AS `id`,`treatment`.`treatment` AS `treatment`,`treatment`.`id` AS `treatmentid`,`treatmentplan`.`treatmentplan` AS `treatmentplan`,`treatmentplan`.`primarypatient` AS `primarypatient`,`treatmentplan`.`patient` AS `patient`,`treatmentplan`.`provider` AS `providerid`,sum(ifnull(`treatmentplan`.`totaltreatmentcost`,0)) AS `totaltreatmentcost`,sum(ifnull(`treatmentplan`.`totalcopay`,0)) AS `totalcopay`,sum(ifnull(`treatmentplan`.`totalinspays`,0)) AS `totalinspays`,((sum(ifnull(`treatmentplan`.`totaltreatmentcost`,0)) - sum(ifnull(`treatmentplan`.`totalinspays`,0))) - sum(ifnull(`treatmentplan`.`totalinspays`,0))) AS `totalmemberpays`,sum(ifnull(`treatmentplan`.`totalpaid`,0)) AS `totalpaid`,sum(ifnull(`treatmentplan`.`totalcopaypaid`,0)) AS `totalcopaypaid`,sum(ifnull(`treatmentplan`.`totalinspaid`,0)) AS `totalinspaid`,sum(ifnull(`treatmentplan`.`totaldue`,0)) AS `totaldue`,`vw_memberpatientlist`.`email` AS `memberemail`,`vw_memberpatientlist`.`cell` AS `membercell`,concat(`vw_memberpatientlist`.`fname`,' ',`vw_memberpatientlist`.`lname`,' (',`vw_memberpatientlist`.`patientmember`,')') AS `membername`,concat(`vw_memberpatientlist`.`cell`,'-',`vw_memberpatientlist`.`email`) AS `membercontact`,concat(`patientmember`.`address1`,' ',`patientmember`.`address2`,' ',`patientmember`.`city`,' ',`patientmember`.`st`,' ',`patientmember`.`pin`) AS `memberaddress`,`provider`.`providername` AS `providername`,concat(`provider`.`address1`,' ',`provider`.`address2`,' ',`provider`.`city`,' ',`provider`.`st`,' ',`provider`.`pin`) AS `provaddress`,concat(`provider`.`cell`,'-',`provider`.`email`) AS `provcontact`,concat(`company`.`name`,' (',`company`.`company`,')') AS `company`,concat(`hmoplan`.`name`,' (',`hmoplan`.`hmoplancode`,')') AS `hmoplan`,`vw_memberpatientlist`.`premenddt` AS `premenddt`,`treatmentplan`.`is_active` AS `is_active` from ((((((`treatmentplan` left join `vw_memberpatientlist` on((((`treatmentplan`.`primarypatient` = `vw_memberpatientlist`.`primarypatientid`) & (`treatmentplan`.`patient` = `vw_memberpatientlist`.`patientid`)) & (`vw_memberpatientlist`.`is_active` = 'T')))) left join `provider` on((`treatmentplan`.`provider` = `provider`.`id`))) left join `company` on((`vw_memberpatientlist`.`company` = `company`.`id`))) left join `hmoplan` on((`vw_memberpatientlist`.`hmoplan` = `hmoplan`.`id`))) left join `patientmember` on((`treatmentplan`.`primarypatient` = `patientmember`.`id`))) left join `treatment` on((`treatment`.`treatmentplan` = `treatmentplan`.`id`))) group by `treatmentplan`.`primarypatient`,`treatmentplan`.`treatmentplan`,`treatment`.`treatment`;
CREATE VIEW `vw_treatmentplanlist` AS select `treatmentplan`.`id` AS `id`,`treatmentplan`.`treatmentplan` AS `treatmentplan`,`treatmentplan`.`startdate` AS `startdate`,`treatmentplan`.`status` AS `status`,`treatmentplan`.`totaltreatmentcost` AS `totaltreatmentcost`,`treatmentplan`.`totaldue` AS `totaldue`,`treatmentplan`.`patientname` AS `patientname`,`treatmentplan`.`provider` AS `provider`,`treatmentplan`.`is_active` AS `is_active`,`treatmentplan`.`primarypatient` AS `primarypatient`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`fname` AS `fname`,`patientmember`.`lname` AS `lname`,`patientmember`.`cell` AS `cell`,`patientmember`.`email` AS `email` from (`treatmentplan` left join `patientmember` on((`patientmember`.`id` = `treatmentplan`.`primarypatient`)));
CREATE VIEW `vw_treatmentplansummarybypatient` AS select `treatmentplan`.`id` AS `id`,`treatmentplan`.`primarypatient` AS `memberid`,`treatmentplan`.`patient` AS `patientid`,`treatmentplan`.`provider` AS `provider`,`treatmentplan`.`is_active` AS `is_active`,sum(`treatmentplan`.`totaltreatmentcost`) AS `totalcost`,sum(`treatmentplan`.`totalcopay`) AS `totalcopay`,sum(`treatmentplan`.`totalinspays`) AS `totalinspays`,sum(`treatmentplan`.`totalpaid`) AS `totalpaid`,sum(`treatmentplan`.`totaldue`) AS `totaldue`,sum(`treatmentplan`.`totalcopaypaid`) AS `totalcopaypaid`,sum(`treatmentplan`.`totalinspaid`) AS `totalinspaid` from `treatmentplan` where (`treatmentplan`.`is_active` = 'T') group by `treatmentplan`.`provider`,`treatmentplan`.`primarypatient`,`treatmentplan`.`patient`;
CREATE VIEW `vw_treatmentplansummarybytreatment` AS select `treatmentplan`.`id` AS `id`,`treatmentplan`.`provider` AS `provider`,`treatmentplan`.`is_active` AS `is_active`,sum(`treatmentplan`.`totaltreatmentcost`) AS `totalcost`,sum(`treatmentplan`.`totalcopay`) AS `totalcopay`,sum(`treatmentplan`.`totalinspays`) AS `totalinspays`,`vw_paymenttotalpaid`.`totalpaid` AS `totalpaid`,((sum(`treatmentplan`.`totalcopay`) - sum(`treatmentplan`.`totalinspays`)) - `vw_paymenttotalpaid`.`totalpaid`) AS `totaldue`,sum(`treatmentplan`.`totalcopaypaid`) AS `totalcopaypaid`,sum(`treatmentplan`.`totalinspaid`) AS `totalinspaid` from (`treatmentplan` left join `vw_paymenttotalpaid` on((`vw_paymenttotalpaid`.`treatmentplan` = `treatmentplan`.`id`))) where (`treatmentplan`.`is_active` = 'T') group by `treatmentplan`.`id`;
CREATE VIEW `vw_treatmentprocedure` AS select `treatment_procedure`.`id` AS `id`,`treatment_procedure`.`treatmentid` AS `treatmentid`,`vw_procedurepriceplan`.`procedurecode` AS `procedurecode`,`vw_procedurepriceplan`.`altshortdescription` AS `altshortdescription`,`vw_procedurepriceplan`.`relgrproc` AS `relgrproc`,if((`vw_procedurepriceplan`.`relgrproc` = 'T'),`vw_procedurepriceplan`.`relgrprocdesc`,NULL) AS `relgrprocdesc`,`treatment_procedure`.`ucr` AS `ucrfee`,`treatment_procedure`.`procedurefee` AS `procedurefee`,`treatment_procedure`.`copay` AS `copay`,`treatment_procedure`.`inspays` AS `inspays`,`treatment_procedure`.`companypays` AS `companypays`,`treatment_procedure`.`quadrant` AS `quadrant`,`treatment_procedure`.`tooth` AS `tooth`,`treatment_procedure`.`status` AS `status`,`treatment_procedure`.`authorized` AS `authorized`,`treatment_procedure`.`remarks` AS `remarks`,`treatment_procedure`.`treatmentdate` AS `treatmentdate`,`treatment_procedure`.`relgrtransactionid` AS `relgrtransactionid`,`treatment_procedure`.`relgrtransactionamt` AS `relgrtransactionamt`,`treatment_procedure`.`service_id` AS `service_id`,`treatment_procedure`.`is_active` AS `is_active`,`treatmentplan`.`primarypatient` AS `primarypatient`,`treatmentplan`.`patient` AS `patient`,`treatmentplan`.`treatmentplan` AS `treatmentplan`,`treatmentplan`.`provider` AS `providerid`,`treatment`.`treatment` AS `treatment` from (((`treatment_procedure` left join `treatment` on((`treatment`.`id` = `treatment_procedure`.`treatmentid`))) left join `treatmentplan` on((`treatmentplan`.`id` = `treatment`.`treatmentplan`))) left join `vw_procedurepriceplan` on((`vw_procedurepriceplan`.`id` = `treatment_procedure`.`dentalprocedure`)));
CREATE VIEW `vw_treatment_procedure_group` AS select `vw_treatmentprocedure`.`id` AS `id`,`vw_treatmentprocedure`.`treatmentid` AS `treatmentid`,group_concat(`dentalprocedure`.`shortdescription` separator ';') AS `shortdescription` from ((`vw_treatmentprocedure` left join `treatment` on((`treatment`.`id` = `vw_treatmentprocedure`.`treatmentid`))) left join `dentalprocedure` on((`dentalprocedure`.`dentalprocedure` = `vw_treatmentprocedure`.`procedurecode`))) where (`vw_treatmentprocedure`.`is_active` = 'T') group by `vw_treatmentprocedure`.`treatmentid`;
CREATE VIEW `vw_paymentgroup` AS select `payment`.`treatmentplan` AS `id`,max(`payment`.`modified_on`) AS `lastpaymentdate`,max(`payment`.`paymentdate`) AS `paymentdate`,count(`payment`.`id`) AS `paymentscount`,`payment`.`amount` AS `amount` from `payment` group by `payment`.`treatmentplan` order by `payment`.`modified_on` desc;
CREATE VIEW `vw_payments` AS select `treatmentplan`.`id` AS `id`,`treatment`.`treatment` AS `treatment`,`treatment`.`id` AS `treatmentid`,`treatment`.`startdate` AS `treatmentdate`,`vw_treatment_procedure_group`.`shortdescription` AS `shortdescription`,`treatmentplan`.`primarypatient` AS `memberid`,`treatmentplan`.`patient` AS `patientid`,`treatmentplan`.`provider` AS `providerid`,`vw_memberpatientlist`.`fullname` AS `patientname`,sum(`treatmentplan`.`totaltreatmentcost`) AS `totaltreatmentcost`,sum(`treatmentplan`.`totalcopay`) AS `totalcopay`,sum(`treatmentplan`.`totalinspays`) AS `totalinspays`,ifnull(`vw_paymenttotalpaid`.`totalpaid`,0) AS `totalpaid`,max(`vw_paymenttotalpaid`.`lastpaymentdate`) AS `lastpaymentdate`,(sum(`treatmentplan`.`totalcopay`) - ifnull(`vw_paymenttotalpaid`.`totalpaid`,0)) AS `totaldue`,sum(`treatmentplan`.`totalcopaypaid`) AS `totalcopaypaid`,sum(`treatmentplan`.`totalinspaid`) AS `totalinspaid`,`treatmentplan`.`is_active` AS `is_active` from ((((`treatmentplan` left join `vw_paymenttotalpaid` on((`vw_paymenttotalpaid`.`treatmentplan` = `treatmentplan`.`id`))) left join `treatment` on((`treatment`.`treatmentplan` = `treatmentplan`.`id`))) left join `vw_treatment_procedure_group` on((`vw_treatment_procedure_group`.`treatmentid` = `treatment`.`id`))) left join `vw_memberpatientlist` on(((`vw_memberpatientlist`.`primarypatientid` = `treatmentplan`.`primarypatient`) and (`vw_memberpatientlist`.`patientid` = `treatmentplan`.`patient`)))) group by `treatment`.`id` desc,`treatment`.`startdate` desc;

CREATE VIEW `vw_paymentlist` AS select `payment`.`id` AS `id`,`treatmentplan`.`id` AS `tplanid`,`treatmentplan`.`patient` AS `patientid`,`treatmentplan`.`primarypatient` AS `memberid`,`payment`.`paymentdate` AS `paymentdate`,`payment`.`amount` AS `amount`,`payment`.`paymenttype` AS `paymenttype`,`payment`.`paymentmode` AS `paymentmode`,`payment`.`payor` AS `payor`,`treatmentplan`.`treatmentplan` AS `treatmentplan`,`patientmember`.`title` AS `title`,`treatmentplan`.`patientname` AS `patientname`,concat(`patientmember`.`fname`,' ',`patientmember`.`lname`,' (',`patientmember`.`patientmember`,')') AS `patientmember`,`treatmentplan`.`totaltreatmentcost` AS `totaltreatmentcost`,`treatmentplan`.`totalcopay` AS `totalcopay`,`treatmentplan`.`totalinspays` AS `totalinspays`,`treatmentplan`.`totalpaid` AS `totalpaid`,`treatmentplan`.`totalcopaypaid` AS `totalcopaypaid`,`treatmentplan`.`totalinspaid` AS `totalinspaid`,`treatmentplan`.`totaldue` AS `totaldue`,`payment`.`is_active` AS `is_active`,`payment`.`paymentcommit` AS `paymentcommit`,`payment`.`provider` AS `providerid`,`treatment`.`treatment` AS `treatment`,`treatment`.`id` AS `treatmentid`,`payment`.`fp_status` AS `fppaymentstatus`,`payment`.`fp_paymentref` AS `fppaymentref`,`payment`.`fp_paymenttype` AS `fppaymenttype`,`payment`.`fp_paymentdetail` AS `fppaymentdetail`,`payment`.`fp_cardtype` AS `fppaymentcard`,`payment`.`fp_invoice` AS `fpinvoice` from (((`payment` left join `treatmentplan` on((`treatmentplan`.`id` = `payment`.`treatmentplan`))) left join `treatment` on((`treatment`.`treatmentplan` = `treatmentplan`.`id`))) left join `patientmember` on((`patientmember`.`id` = `payment`.`patientmember`)));


CREATE VIEW `vw_doctor` AS select `dr`.`id` AS `id`,`dr`.`id` AS `doctorid`,`dr`.`title` AS `doctortitle`,`dr`.`name` AS `doctorname`,`dr`.`providerid` AS `providerid`,`dr`.`speciality` AS `specialityid`,`sp`.`speciality` AS `speciality`,`dr`.`role` AS `roleid`,`rl`.`role` AS `role`,`dr`.`practice_owner` AS `practice_owner`,`dr`.`email` AS `email`,`dr`.`cell` AS `cell`,`dr`.`registration` AS `registration`,`dr`.`color` AS `color`,`dr`.`stafftype` AS `stafftype`,`dr`.`notes` AS `notes`,`dr`.`is_active` AS `is_active` from ((`doctor` `dr` left join `speciality` `sp` on(((`dr`.`speciality` = `sp`.`id`) and (`dr`.`providerid` = `sp`.`providerid`)))) left join `role` `rl` on(((`dr`.`role` = `rl`.`id`) and (`dr`.`providerid` = `rl`.`providerid`))));


CREATE VIEW `vw_memberpaymentx` AS select `vw_paymenttxlog`.`memberid` AS `memberid`,max(`vw_paymenttxlog`.`txdatetime`) AS `paymentdate`,sum(`vw_paymenttxlog`.`total`) AS `amount` from `vw_paymenttxlog` where ((`vw_paymenttxlog`.`responsecode` <> '999') and (`vw_paymenttxlog`.`is_active` = 'T')) group by `vw_paymenttxlog`.`memberid` order by `vw_paymenttxlog`.`memberid`;
CREATE VIEW `vw_providerreveniewytd` AS select `vw_paymentlist`.`providerid` AS `providerid`,year(`vw_paymentlist`.`paymentdate`) AS `paymentyear`,sum(`vw_paymentlist`.`amount`) AS `earnedrevenue` from ((`vw_paymentlist` left join `patientmember` on((`patientmember`.`id` = `vw_paymentlist`.`memberid`))) left join `provider` on((`provider`.`id` = `vw_paymentlist`.`providerid`))) where ((`patientmember`.`is_active` = 'T') and (`patientmember`.`hmopatientmember` = 'T') and (`vw_paymentlist`.`is_active` = 'T') and (`vw_paymentlist`.`paymentcommit` = 'T') and (`vw_paymentlist`.`fppaymentstatus` = 'S') and (`provider`.`is_active` = 'T')) group by `paymentyear`,`vw_paymentlist`.`providerid`;
CREATE VIEW `vw_providertotalrevenue` AS select `vw_paymentlist`.`providerid` AS `providerid`,max(year(`vw_paymentlist`.`paymentdate`)) AS `paymentyear`,sum(`vw_paymentlist`.`amount`) AS `earnedrevenue` from ((`vw_paymentlist` left join `patientmember` on((`patientmember`.`id` = `vw_paymentlist`.`memberid`))) left join `provider` on((`provider`.`id` = `vw_paymentlist`.`providerid`))) where ((`patientmember`.`is_active` = 'T') and (`patientmember`.`hmopatientmember` = 'T') and (`vw_paymentlist`.`is_active` = 'T') and (`vw_paymentlist`.`paymentcommit` = 'T') and (`vw_paymentlist`.`fppaymentstatus` = 'S') and (`provider`.`is_active` = 'T')) group by `vw_paymentlist`.`providerid`;



CREATE VIEW `vw_memberdata` AS select `patientmember`.`id` AS `id`,`patientmember`.`id` AS `patientid`,`patientmember`.`id` AS `primarypatientid`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`groupref` AS `groupref`,'P' AS `patienttype`,`patientmember`.`fname` AS `fname`,`patientmember`.`mname` AS `mname`,`patientmember`.`lname` AS `lname`,`patientmember`.`address1` AS `address1`,`patientmember`.`address2` AS `address2`,`patientmember`.`address3` AS `address3`,`patientmember`.`city` AS `city`,`patientmember`.`st` AS `st`,`patientmember`.`pin` AS `pin`,`patientmember`.`cell` AS `cell`,`patientmember`.`email` AS `email`,`patientmember`.`dob` AS `dob`,`patientmember`.`gender` AS `gender`,'Self' AS `relation`,`patientmember`.`status` AS `status`,`patientmember`.`premium` AS `premium`,`patientmember`.`renewed` AS `renewed`,`patientmember`.`upgraded` AS `upgraded`,`patientmember`.`is_active` AS `is_active`,cast(`patientmember`.`premstartdt` as date) AS `premstartdt`,cast(`patientmember`.`premenddt` as date) AS `premenddt`,`hmoplan`.`name` AS `hmoplanname`,`hmoplan`.`hmoplancode` AS `hmoplancode`,`company`.`company` AS `companycode`,`provider`.`provider` AS `provider`,`provider`.`address1` AS `provaddress1`,`provider`.`address2` AS `provaddress2`,`provider`.`address3` AS `provaddress3`,`provider`.`city` AS `provcity`,`provider`.`st` AS `provst`,`provider`.`pin` AS `provpin`,`provider`.`cell` AS `provcell`,`provider`.`email` AS `provemail`,`provider`.`is_active` AS `provactive`,`company`.`is_active` AS `compactive`,`hmoplan`.`is_active` AS `hmoactive` from (((`patientmember` left join `hmoplan` on((`patientmember`.`hmoplan` = `hmoplan`.`id`))) left join `company` on((`patientmember`.`company` = `company`.`id`))) left join `provider` on((`patientmember`.`provider` = `provider`.`id`))) union select `patientmemberdependants`.`id` AS `id`,`patientmemberdependants`.`id` AS `patientid`,`patientmemberdependants`.`patientmember` AS `primarypatientid`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`groupref` AS `groupref`,'D' AS `patienttype`,`patientmemberdependants`.`fname` AS `fname`,`patientmemberdependants`.`mname` AS `mname`,`patientmemberdependants`.`lname` AS `lname`,`patientmember`.`address1` AS `address1`,`patientmember`.`address2` AS `address2`,`patientmember`.`address3` AS `address3`,`patientmember`.`city` AS `city`,`patientmember`.`st` AS `st`,`patientmember`.`pin` AS `pin`,`patientmember`.`cell` AS `cell`,`patientmember`.`email` AS `email`,`patientmemberdependants`.`depdob` AS `dob`,`patientmemberdependants`.`gender` AS `gender`,`patientmemberdependants`.`relation` AS `relation`,`patientmember`.`status` AS `status`,0 AS `premium`,`patientmember`.`renewed` AS `renewed`,`patientmember`.`upgraded` AS `upgraded`,`patientmemberdependants`.`is_active` AS `is_active`,cast(`patientmember`.`premstartdt` as date) AS `premstartdt`,cast(`patientmember`.`premenddt` as date) AS `premenddt`,`hmoplan`.`name` AS `hmoplanname`,`hmoplan`.`hmoplancode` AS `hmoplancode`,`company`.`company` AS `companycode`,`provider`.`provider` AS `provider`,`provider`.`address1` AS `provaddress1`,`provider`.`address2` AS `provaddress2`,`provider`.`address3` AS `provaddress3`,`provider`.`city` AS `provcity`,`provider`.`st` AS `provst`,`provider`.`pin` AS `provpin`,`provider`.`cell` AS `provcell`,`provider`.`email` AS `provemail`,`provider`.`is_active` AS `provactive`,`company`.`is_active` AS `compactive`,`hmoplan`.`is_active` AS `hmoactive` from ((((`patientmemberdependants` left join `patientmember` on((`patientmember`.`id` = `patientmemberdependants`.`patientmember`))) left join `hmoplan` on((`patientmember`.`hmoplan` = `hmoplan`.`id`))) left join `company` on((`patientmember`.`company` = `company`.`id`))) left join `provider` on((`patientmember`.`provider` = `provider`.`id`))) where (`patientmember`.`hmopatientmember` = 'T');

CREATE VIEW `vw_memberpaymentreport` AS select `payment`.`id` AS `id`,`payment`.`fp_paymentref` AS `fppaymentref`,`payment`.`fp_paymenttype` AS `fppaymenttype`,`payment`.`fp_invoice` AS `fpinvoice`,`payment`.`fp_paymentdate` AS `paymentdate`,`payment`.`fp_invoiceamt` AS `invoiceamount`,`payment`.`fp_amount` AS `paymentamount`,'P' AS `patienttype`,`patientmember`.`patientmember` AS `patientmember`,`patientmember`.`fname` AS `fname`,`patientmember`.`mname` AS `mname`,`patientmember`.`lname` AS `lname`,`patientmember`.`city` AS `city`,`patientmember`.`st` AS `st`,`patientmember`.`pin` AS `pin`,`patientmember`.`cell` AS `cell`,`patientmember`.`email` AS `email`,`provider`.`provider` AS `provider`,`provider`.`practicename` AS `practicename`,`provider`.`city` AS `provcity`,`provider`.`st` AS `provst`,`provider`.`pin` AS `provpin`,`provider`.`cell` AS `provcell`,`provider`.`email` AS `provemail`,`treatment`.`id` AS `treatmentid`,`treatment`.`treatment` AS `treatment`,`vw_treatment_procedure_group`.`shortdescription` AS `shortdescription`,`treatmentplan`.`totaltreatmentcost` AS `totaltreatmentcost`,`treatmentplan`.`totalcopay` AS `totalcopay`,`treatmentplan`.`totalinspays` AS `totalinspays`,`treatmentplan`.`totalpaid` AS `totalpaid`,`treatmentplan`.`totalcopaypaid` AS `totalcopaypaid`,`treatmentplan`.`totalinspaid` AS `totalinspaid`,`treatmentplan`.`totaldue` AS `totaldue` from (((((`payment` left join `patientmember` on((`patientmember`.`id` = `payment`.`patientmember`))) left join `provider` on((`provider`.`id` = `payment`.`provider`))) left join `treatmentplan` on((`treatmentplan`.`id` = `payment`.`treatmentplan`))) left join `treatment` on((`treatment`.`treatmentplan` = `treatmentplan`.`id`))) left join `vw_treatment_procedure_group` on((`vw_treatment_procedure_group`.`treatmentid` = `treatment`.`id`))) where ((`payment`.`paymentcommit` = 'T') and (`payment`.`is_active` = 'T') and (`payment`.`fp_status` = 'S') and (`payment`.`is_active` = 'T') and (`patientmember`.`hmopatientmember` = 'T') and (`provider`.`is_active` = 'T') and (`treatment`.`is_active` = 'T') and (`treatmentplan`.`is_active` = 'T')) order by `patientmember`.`patientmember`,`treatment`.`treatment`;

CREATE VIEW `vw_rlgprovider` AS select `rlgprovider`.`providerid` AS `id`,`rlgprovider`.`providerid` AS `providerid`,`rlgprovider`.`providercode` AS `providercode`,`rlgprovider`.`regionid` AS `regionid`,`rlgprovider`.`planid` AS `planid`,`rlgprovider`.`is_active` AS `is_active`,`provider`.`providername` AS `providername` from (`rlgprovider` left join `provider` on((`rlgprovider`.`providerid` = `provider`.`id`)));

CREATE VIEW `vw_relgrtreatmentprocedure` AS select `vw_memberpatientlist`.`fullname` AS `fullname`,`vw_memberpatientlist`.`cell` AS `cell`,`vw_memberpatientlist`.`groupref` AS `groupref`,`vw_memberpatientlist`.`patientmember` AS `patientmember`,`company`.`company` AS `company`,`rlgprovider`.`providerid` AS `providerid`,`rlgprovider`.`providercode` AS `providercode`,`provider`.`pa_providername` AS `providername`,`provider`.`pa_practicename` AS `practicename`,`provider`.`pa_regno` AS `regno`,`provider`.`pa_practiceaddress` AS `practiceaddress`,`vw_treatmentprocedure`.`treatment` AS `treatment`,`vw_treatmentprocedure`.`treatmentdate` AS `treatmentdate`,`vw_treatmentprocedure`.`service_id` AS `service_id`,`vw_treatmentprocedure`.`procedurecode` AS `procedurecode`,`vw_treatmentprocedure`.`altshortdescription` AS `procdesc`,`vw_treatmentprocedure`.`procedurefee` AS `procedurefee`,`vw_treatmentprocedure`.`copay` AS `copay`,`vw_treatmentprocedure`.`inspays` AS `inspays`,round((`vw_treatmentprocedure`.`inspays` * (1 + (`urlproperties`.`servicetax` / 100))),2) AS `inspays_GST`,`vw_treatmentprocedure`.`tooth` AS `tooth`,`vw_treatmentprocedure`.`quadrant` AS `quadrant`,`vw_treatmentprocedure`.`relgrprocdesc` AS `relgrprocdesc`,`vw_treatmentprocedure`.`relgrproc` AS `relgrproc`,`vw_treatmentprocedure`.`status` AS `status`,`vw_treatmentprocedure`.`is_active` AS `is_active`,`vw_treatmentprocedure`.`relgrtransactionid` AS `relgrtransactionid` from (((((`rlgprovider` left join `provider` on((`provider`.`id` = `rlgprovider`.`providerid`))) left join `vw_treatmentprocedure` on(((`vw_treatmentprocedure`.`providerid` = `rlgprovider`.`providerid`) and (`vw_treatmentprocedure`.`relgrproc` = 'T')))) left join `vw_memberpatientlist` on(((`vw_memberpatientlist`.`primarypatientid` = `vw_treatmentprocedure`.`primarypatient`) and (`vw_memberpatientlist`.`patientid` = `vw_treatmentprocedure`.`patient`)))) left join `company` on((`company`.`id` = `vw_memberpatientlist`.`company`))) left join `urlproperties` on((`urlproperties`.`id` = 1)));



